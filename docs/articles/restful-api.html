<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Accessing the RESTful API • ruODK</title>
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js" integrity="sha256-FgpCb/KJQlLNfOu91ta32o/NMZxltwRo8QtmkMRdAu8=" crossorigin="anonymous"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.3.7/css/bootstrap.min.css" integrity="sha256-916EbMg70RQy9LHiGkXzG8hSg9EdNy97GazNG/aiY1w=" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.3.7/js/bootstrap.min.js" integrity="sha256-U5ZEeKfGNOja007MMD3YBI0A3OSZOQbeG6z2f2Y0hu8=" crossorigin="anonymous"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.7.1/css/all.min.css" integrity="sha256-nAmazAk6vS34Xqo0BSrTb+abbtFlgsFK7NKSi6o7Y78=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.7.1/css/v4-shims.min.css" integrity="sha256-6qHlizsOWFskGlwVOKuns+D1nB6ssZrHQrNj1wGplHc=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.4/clipboard.min.js" integrity="sha256-FiZwavyI2V6+EXO1U+xzLG3IKldpiTFf3153ea9zikQ=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.9.4/headroom.min.js" integrity="sha256-DJFC1kqIhelURkuza0AvYal5RxMtpzLjFhsnVIeuk+U=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.9.4/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script><meta property="og:title" content="Accessing the RESTful API">
<meta property="og:description" content="">
<meta name="twitter:card" content="summary">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body>
    <div class="container template-article">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">ruODK</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">0.6.6.9008</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="../index.html">
    <span class="fas fa fas fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../articles/odata-api.html">Accessing the OData API</a>
    </li>
    <li>
      <a href="../articles/restful-api.html">Accessing the RESTful API</a>
    </li>
    <li>
      <a href="../articles/setup.html">Setup</a>
    </li>
  </ul>
</li>
<li>
  <a href="../news/index.html">Changelog</a>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right">
<li>
  <a href="https://github.com/dbca-wa/ruODK">
    <span class="fab fa fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      

      </header><script src="restful-api_files/htmlwidgets-1.5.1/htmlwidgets.js"></script><link href="restful-api_files/jsoneditor-5.25.6/jsoneditor.min.css" rel="stylesheet">
<script src="restful-api_files/jsoneditor-5.25.6/jsoneditor.min.js"></script><script src="restful-api_files/jsonedit-binding-3.0.0/jsonedit.js"></script><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1>Accessing the RESTful API</h1>
            
      
      <small class="dont-index">Source: <a href="https://github.com/dbca-wa/ruODK/blob/master/vignettes/restful-api.Rmd"><code>vignettes/restful-api.Rmd</code></a></small>
      <div class="hidden name"><code>restful-api.Rmd</code></div>

    </div>

    
    
<div id="scope" class="section level1">
<h1 class="hasAnchor">
<a href="#scope" class="anchor"></a>Scope</h1>
<p>This vignette provides a guided walk-through of the “getting data out” functions of the RESTful API endpoints which list and view details.</p>
<p><code>ruODK</code> users would mix and match parts of the demonstrated workflows to build their own data pipelines, e.g.:</p>
<ul>
<li>to build a quick analysis from all data, freshly downloaded from a smaller project, or</li>
<li>to build an interactive ETL pipeline to selectively download only new submissions for further processing and upload into downstream data warehouses.</li>
</ul>
<p>A typical and more stream-lined workflow is provided in the RMarkdown template “ODK Central via OData” which is supplied by <code>ruODK</code>.</p>
<div id="three-ways-to-happiness" class="section level2">
<h2 class="hasAnchor">
<a href="#three-ways-to-happiness" class="anchor"></a>Three ways to happiness</h2>
<p>ODK Central offers no less than three different ways to access data:</p>
<ul>
<li>viewing ODK Central data in MS PowerBI, MS Excel, Tableau, or <code>ruODK</code> through the OData service endpoints, or</li>
<li>downloading all submissions including attachments as one (possibly gigantic) zip archive either through the “Export Submissions” button in the ODK Central form submissions page or through <code>ruODK</code>, or</li>
<li>viewing ODK Central data through <code>ruODK</code>’s RESTful API functions.</li>
</ul>
<p>While the <code>vignette("odata", package="ruODK")</code> (online <a href="https://dbca-wa.github.io/ruODK/articles/odata-api.html">here</a>) illustrates the first option, this vignette demonstrates the remaining two.</p>
<p>Not implemented (yet) are the “managing ODK Central” functions which create, update, and delete projects, forms, users, roles, and permissions. We haven’t yet found a strong use case to automate those functions - ODK Central (driven by humans) does those jobs beautifully on an expected scale.</p>
</div>
</div>
<div id="setup-ruodk" class="section level1">
<h1 class="hasAnchor">
<a href="#setup-ruodk" class="anchor"></a>Setup ruODK</h1>
<p>See <a href="https://dbca-wa.github.io/ruODK/articles/setup.html"><code>vignette("Setup", package = "ruODK")</code></a> for detailed options to configure <code>ruODK</code>.</p>
<p>Here, we’ll grab the OData service URL from the form used in this vignette, plus username and password of a web user of ODK Central with access to that form.</p>
<p><code><a href="../reference/ru_setup.html">ruODK::ru_setup()</a></code> will populate the default url, project ID, and form ID which are used by <code>ruODK</code>’s other functions (unless specified otherwise).</p>
<div class="sourceCode" id="cb1"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb1-1" title="1"><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span>(ruODK)</a>
<a class="sourceLine" id="cb1-2" title="2">ruODK<span class="op">::</span><span class="kw"><a href="https://rdrr.io/pkg/ruODK/man/ru_setup.html">ru_setup</a></span>(</a>
<a class="sourceLine" id="cb1-3" title="3">  <span class="dt">svc =</span> <span class="st">"https://sandbox.central.opendatakit.org/v1/projects/14/forms/build_Flora-Quadrat-0-4_1564384341.svc"</span>,</a>
<a class="sourceLine" id="cb1-4" title="4">  <span class="dt">un =</span> <span class="kw"><a href="https://rdrr.io/r/base/Sys.getenv.html">Sys.getenv</a></span>(<span class="st">"ODKC_TEST_UN"</span>),</a>
<a class="sourceLine" id="cb1-5" title="5">  <span class="dt">pw =</span> <span class="kw"><a href="https://rdrr.io/r/base/Sys.getenv.html">Sys.getenv</a></span>(<span class="st">"ODKC_TEST_PW"</span>)</a>
<a class="sourceLine" id="cb1-6" title="6">)</a>
<a class="sourceLine" id="cb1-7" title="7"><span class="co">#&gt; &lt;ruODK settings&gt;</span></a>
<a class="sourceLine" id="cb1-8" title="8"><span class="co">#&gt;   Default ODK Central Project ID:  14 </span></a>
<a class="sourceLine" id="cb1-9" title="9"><span class="co">#&gt;   Default ODK Central Form ID:  build_Flora-Quadrat-0-4_1564384341 </span></a>
<a class="sourceLine" id="cb1-10" title="10"><span class="co">#&gt;   Default ODK Central URL:  https://sandbox.central.opendatakit.org </span></a>
<a class="sourceLine" id="cb1-11" title="11"><span class="co">#&gt;   Default ODK Central Username:  Florian.Mayer@dbca.wa.gov.au </span></a>
<a class="sourceLine" id="cb1-12" title="12"><span class="co">#&gt;   Default ODK Central Password: run ruODK::get_default_pw() to show </span></a>
<a class="sourceLine" id="cb1-13" title="13"><span class="co">#&gt;   Test ODK Central Project ID: 14 </span></a>
<a class="sourceLine" id="cb1-14" title="14"><span class="co">#&gt;   Test ODK Central Form ID: build_Flora-Quadrat-0-4_1564384341 </span></a>
<a class="sourceLine" id="cb1-15" title="15"><span class="co">#&gt;   Test ODK Central Form ID (ZIP tests): build_Spotlighting-0-6_1558333698 </span></a>
<a class="sourceLine" id="cb1-16" title="16"><span class="co">#&gt;   Test ODK Central Form ID (Attachment tests): build_Flora-Quadrat-0-1_1558330379 </span></a>
<a class="sourceLine" id="cb1-17" title="17"><span class="co">#&gt;   Test ODK Central Form ID (Parsing tests): build_Turtle-Track-or-Nest-1-0_1569907666 </span></a>
<a class="sourceLine" id="cb1-18" title="18"><span class="co">#&gt;   Test ODK Central URL: https://sandbox.central.opendatakit.org </span></a>
<a class="sourceLine" id="cb1-19" title="19"><span class="co">#&gt;   Test ODK Central Username: Florian.Mayer@dbca.wa.gov.au </span></a>
<a class="sourceLine" id="cb1-20" title="20"><span class="co">#&gt;   Test ODK Central Password: run ruODK::get_test_pw() to show</span></a></code></pre></div>
</div>
<div id="projects" class="section level1">
<h1 class="hasAnchor">
<a href="#projects" class="anchor"></a>Projects</h1>
<p>List projects. We see the project ID, a name, the number of forms and app users, dates of last form submissions plus project management timestamps (created, updated).</p>
<p>The important bit here is the project ID.</p>
<div class="sourceCode" id="cb2"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb2-1" title="1">fq_project_list &lt;-<span class="st"> </span>ruODK<span class="op">::</span><span class="kw"><a href="https://rdrr.io/pkg/ruODK/man/project_list.html">project_list</a></span>()</a></code></pre></div>
<div class="sourceCode" id="cb3"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb3-1" title="1">fq_project_list <span class="op">%&gt;%</span><span class="st"> </span>knitr<span class="op">::</span><span class="kw"><a href="https://rdrr.io/pkg/knitr/man/kable.html">kable</a></span>(.)</a></code></pre></div>
<table class="table">
<thead><tr class="header">
<th align="right">id</th>
<th align="left">name</th>
<th align="right">forms</th>
<th align="right">app_users</th>
<th align="left">created_at</th>
<th align="left">updated_at</th>
<th align="left">last_submission</th>
<th align="left">archived</th>
</tr></thead>
<tbody>
<tr class="odd">
<td align="right">59</td>
<td align="left">1Horizon test project</td>
<td align="right">1</td>
<td align="right">2</td>
<td align="left">2020-01-13 12:45:32</td>
<td align="left">NA</td>
<td align="left">2020-01-13 15:06:15</td>
<td align="left">FALSE</td>
</tr>
<tr class="even">
<td align="right">57</td>
<td align="left">AB’s</td>
<td align="right">1</td>
<td align="right">1</td>
<td align="left">2020-01-06 00:56:00</td>
<td align="left">NA</td>
<td align="left">NA</td>
<td align="left">FALSE</td>
</tr>
<tr class="odd">
<td align="right">8</td>
<td align="left">AmenazasRD</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="left">2019-04-14 06:21:00</td>
<td align="left">NA</td>
<td align="left">NA</td>
<td align="left">FALSE</td>
</tr>
<tr class="even">
<td align="right">9</td>
<td align="left">BAFCO Test</td>
<td align="right">1</td>
<td align="right">1</td>
<td align="left">2019-04-19 00:30:45</td>
<td align="left">NA</td>
<td align="left">2019-04-19 01:26:49</td>
<td align="left">FALSE</td>
</tr>
<tr class="odd">
<td align="right">47</td>
<td align="left">Building Materials Reuse</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="left">2019-10-16 05:07:56</td>
<td align="left">NA</td>
<td align="left">NA</td>
<td align="left">FALSE</td>
</tr>
<tr class="even">
<td align="right">11</td>
<td align="left">CaVaTeCo</td>
<td align="right">2</td>
<td align="right">1</td>
<td align="left">2019-04-30 06:43:22</td>
<td align="left">NA</td>
<td align="left">2019-04-30 08:07:55</td>
<td align="left">FALSE</td>
</tr>
<tr class="odd">
<td align="right">18</td>
<td align="left">CherryPatch</td>
<td align="right">2</td>
<td align="right">1</td>
<td align="left">2019-05-27 21:09:33</td>
<td align="left">NA</td>
<td align="left">2019-05-28 17:32:15</td>
<td align="left">FALSE</td>
</tr>
<tr class="even">
<td align="right">32</td>
<td align="left">Collect3289v2</td>
<td align="right">1</td>
<td align="right">2</td>
<td align="left">2019-08-07 12:52:56</td>
<td align="left">NA</td>
<td align="left">2019-08-07 13:44:19</td>
<td align="left">FALSE</td>
</tr>
<tr class="odd">
<td align="right">4</td>
<td align="left">Curso</td>
<td align="right">7</td>
<td align="right">5</td>
<td align="left">2019-02-26 03:55:50</td>
<td align="left">NA</td>
<td align="left">2019-03-21 22:22:57</td>
<td align="left">FALSE</td>
</tr>
<tr class="even">
<td align="right">7</td>
<td align="left">DRC Test</td>
<td align="right">1</td>
<td align="right">4</td>
<td align="left">2019-03-29 08:52:32</td>
<td align="left">NA</td>
<td align="left">2019-05-07 13:14:01</td>
<td align="left">FALSE</td>
</tr>
<tr class="odd">
<td align="right">37</td>
<td align="left">Duniatest</td>
<td align="right">2</td>
<td align="right">1</td>
<td align="left">2019-09-12 02:13:54</td>
<td align="left">NA</td>
<td align="left">NA</td>
<td align="left">FALSE</td>
</tr>
<tr class="even">
<td align="right">43</td>
<td align="left">exemple_questionnaire</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="left">2019-10-02 16:11:27</td>
<td align="left">NA</td>
<td align="left">NA</td>
<td align="left">FALSE</td>
</tr>
<tr class="odd">
<td align="right">24</td>
<td align="left">Farmers Survey</td>
<td align="right">1</td>
<td align="right">0</td>
<td align="left">2019-06-25 15:51:47</td>
<td align="left">NA</td>
<td align="left">NA</td>
<td align="left">FALSE</td>
</tr>
<tr class="even">
<td align="right">42</td>
<td align="left">Florian’s tests</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="left">2019-10-02 10:07:55</td>
<td align="left">NA</td>
<td align="left">NA</td>
<td align="left">FALSE</td>
</tr>
<tr class="odd">
<td align="right">1</td>
<td align="left">Forms you made before projects existed</td>
<td align="right">44</td>
<td align="right">29</td>
<td align="left">2019-02-14 17:28:00</td>
<td align="left">NA</td>
<td align="left">2019-08-24 16:10:29</td>
<td align="left">FALSE</td>
</tr>
<tr class="even">
<td align="right">30</td>
<td align="left">FWW Epi Survey</td>
<td align="right">1</td>
<td align="right">1</td>
<td align="left">2019-08-02 15:04:09</td>
<td align="left">NA</td>
<td align="left">2019-08-06 17:19:15</td>
<td align="left">FALSE</td>
</tr>
<tr class="odd">
<td align="right">6</td>
<td align="left">g</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="left">2019-03-27 13:16:47</td>
<td align="left">NA</td>
<td align="left">NA</td>
<td align="left">FALSE</td>
</tr>
<tr class="even">
<td align="right">23</td>
<td align="left">Guillermo’s tests</td>
<td align="right">44</td>
<td align="right">1</td>
<td align="left">2019-06-15 11:30:05</td>
<td align="left">NA</td>
<td align="left">2019-10-02 08:37:58</td>
<td align="left">FALSE</td>
</tr>
<tr class="odd">
<td align="right">38</td>
<td align="left">IFAKARA HEALTH TEST</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="left">2019-09-12 06:37:56</td>
<td align="left">NA</td>
<td align="left">NA</td>
<td align="left">FALSE</td>
</tr>
<tr class="even">
<td align="right">33</td>
<td align="left">issa test</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="left">2019-08-07 22:27:11</td>
<td align="left">NA</td>
<td align="left">NA</td>
<td align="left">FALSE</td>
</tr>
<tr class="odd">
<td align="right">54</td>
<td align="left">kasia_testing</td>
<td align="right">2</td>
<td align="right">1</td>
<td align="left">2019-11-22 09:48:42</td>
<td align="left">NA</td>
<td align="left">2019-11-26 13:38:12</td>
<td align="left">FALSE</td>
</tr>
<tr class="even">
<td align="right">26</td>
<td align="left">Kinshasa</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="left">2019-07-25 19:26:53</td>
<td align="left">NA</td>
<td align="left">NA</td>
<td align="left">FALSE</td>
</tr>
<tr class="odd">
<td align="right">45</td>
<td align="left">KW Test</td>
<td align="right">1</td>
<td align="right">1</td>
<td align="left">2019-10-09 04:25:42</td>
<td align="left">NA</td>
<td align="left">2019-10-12 01:12:36</td>
<td align="left">FALSE</td>
</tr>
<tr class="even">
<td align="right">40</td>
<td align="left">Makerere</td>
<td align="right">1</td>
<td align="right">0</td>
<td align="left">2019-09-27 16:24:18</td>
<td align="left">NA</td>
<td align="left">NA</td>
<td align="left">FALSE</td>
</tr>
<tr class="odd">
<td align="right">34</td>
<td align="left">MBA</td>
<td align="right">1</td>
<td align="right">2</td>
<td align="left">2019-08-13 02:06:28</td>
<td align="left">NA</td>
<td align="left">2019-08-13 03:30:17</td>
<td align="left">FALSE</td>
</tr>
<tr class="even">
<td align="right">56</td>
<td align="left">meterau</td>
<td align="right">1</td>
<td align="right">2</td>
<td align="left">2019-12-10 14:23:21</td>
<td align="left">NA</td>
<td align="left">2019-12-10 14:30:11</td>
<td align="left">FALSE</td>
</tr>
<tr class="odd">
<td align="right">49</td>
<td align="left">Monitoring forms</td>
<td align="right">1</td>
<td align="right">1</td>
<td align="left">2019-10-29 11:00:46</td>
<td align="left">NA</td>
<td align="left">NA</td>
<td align="left">FALSE</td>
</tr>
<tr class="even">
<td align="right">48</td>
<td align="left">Monitoring Forms</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="left">2019-10-25 14:39:47</td>
<td align="left">NA</td>
<td align="left">NA</td>
<td align="left">FALSE</td>
</tr>
<tr class="odd">
<td align="right">2</td>
<td align="left">mon projet</td>
<td align="right">1</td>
<td align="right">0</td>
<td align="left">2019-02-14 19:32:05</td>
<td align="left">NA</td>
<td align="left">NA</td>
<td align="left">FALSE</td>
</tr>
<tr class="even">
<td align="right">3</td>
<td align="left">MyProjects</td>
<td align="right">0</td>
<td align="right">1</td>
<td align="left">2019-02-25 19:31:40</td>
<td align="left">NA</td>
<td align="left">NA</td>
<td align="left">FALSE</td>
</tr>
<tr class="odd">
<td align="right">25</td>
<td align="left">Olivier38</td>
<td align="right">2</td>
<td align="right">1</td>
<td align="left">2019-06-27 15:52:10</td>
<td align="left">NA</td>
<td align="left">2019-07-27 20:14:39</td>
<td align="left">FALSE</td>
</tr>
<tr class="even">
<td align="right">39</td>
<td align="left">Pakistan Test</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="left">2019-09-24 10:32:06</td>
<td align="left">NA</td>
<td align="left">NA</td>
<td align="left">FALSE</td>
</tr>
<tr class="odd">
<td align="right">50</td>
<td align="left">PD Test</td>
<td align="right">5</td>
<td align="right">1</td>
<td align="left">2019-11-20 04:21:46</td>
<td align="left">NA</td>
<td align="left">2019-11-27 09:43:00</td>
<td align="left">FALSE</td>
</tr>
<tr class="even">
<td align="right">21</td>
<td align="left">PresentationTest</td>
<td align="right">0</td>
<td align="right">1</td>
<td align="left">2019-06-11 09:38:45</td>
<td align="left">NA</td>
<td align="left">NA</td>
<td align="left">FALSE</td>
</tr>
<tr class="odd">
<td align="right">51</td>
<td align="left">Project123</td>
<td align="right">0</td>
<td align="right">1</td>
<td align="left">2019-11-20 14:40:04</td>
<td align="left">NA</td>
<td align="left">NA</td>
<td align="left">FALSE</td>
</tr>
<tr class="even">
<td align="right">13</td>
<td align="left">ProjetTest</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="left">2019-05-10 16:04:04</td>
<td align="left">NA</td>
<td align="left">NA</td>
<td align="left">FALSE</td>
</tr>
<tr class="odd">
<td align="right">22</td>
<td align="left">psud test</td>
<td align="right">1</td>
<td align="right">2</td>
<td align="left">2019-06-12 00:20:02</td>
<td align="left">NA</td>
<td align="left">2019-06-12 00:30:26</td>
<td align="left">FALSE</td>
</tr>
<tr class="even">
<td align="right">52</td>
<td align="left">Quality</td>
<td align="right">0</td>
<td align="right">1</td>
<td align="left">2019-11-21 10:25:33</td>
<td align="left">NA</td>
<td align="left">NA</td>
<td align="left">FALSE</td>
</tr>
<tr class="odd">
<td align="right">53</td>
<td align="left">Reception</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="left">2019-11-21 10:26:11</td>
<td align="left">NA</td>
<td align="left">NA</td>
<td align="left">FALSE</td>
</tr>
<tr class="even">
<td align="right">35</td>
<td align="left">Ronald Munjoma Test</td>
<td align="right">2</td>
<td align="right">1</td>
<td align="left">2019-08-18 12:37:29</td>
<td align="left">NA</td>
<td align="left">NA</td>
<td align="left">FALSE</td>
</tr>
<tr class="odd">
<td align="right">14</td>
<td align="left">ruODK package test forms</td>
<td align="right">9</td>
<td align="right">3</td>
<td align="left">2019-05-17 03:10:51</td>
<td align="left">NA</td>
<td align="left">2019-12-03 07:26:14</td>
<td align="left">FALSE</td>
</tr>
<tr class="even">
<td align="right">44</td>
<td align="left">ruODK playground</td>
<td align="right">8</td>
<td align="right">2</td>
<td align="left">2019-10-03 07:49:11</td>
<td align="left">NA</td>
<td align="left">2019-10-22 02:04:14</td>
<td align="left">FALSE</td>
</tr>
<tr class="odd">
<td align="right">29</td>
<td align="left">✨Secret project ✨</td>
<td align="right">1</td>
<td align="right">1</td>
<td align="left">2019-08-02 03:55:59</td>
<td align="left">NA</td>
<td align="left">NA</td>
<td align="left">FALSE</td>
</tr>
<tr class="even">
<td align="right">5</td>
<td align="left">SurveyAir</td>
<td align="right">1</td>
<td align="right">2</td>
<td align="left">2019-03-12 00:15:36</td>
<td align="left">NA</td>
<td align="left">2019-04-11 07:36:35</td>
<td align="left">FALSE</td>
</tr>
<tr class="odd">
<td align="right">16</td>
<td align="left">TBBT</td>
<td align="right">1</td>
<td align="right">1</td>
<td align="left">2019-05-17 12:21:50</td>
<td align="left">NA</td>
<td align="left">2019-05-17 12:29:18</td>
<td align="left">FALSE</td>
</tr>
<tr class="even">
<td align="right">41</td>
<td align="left">test-1</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="left">2019-09-30 08:48:20</td>
<td align="left">NA</td>
<td align="left">NA</td>
<td align="left">FALSE</td>
</tr>
<tr class="odd">
<td align="right">46</td>
<td align="left">Tester1</td>
<td align="right">1</td>
<td align="right">2</td>
<td align="left">2019-10-13 13:16:25</td>
<td align="left">NA</td>
<td align="left">2019-10-13 13:41:13</td>
<td align="left">FALSE</td>
</tr>
<tr class="even">
<td align="right">27</td>
<td align="left">Test form</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="left">2019-07-25 19:35:11</td>
<td align="left">NA</td>
<td align="left">NA</td>
<td align="left">FALSE</td>
</tr>
<tr class="odd">
<td align="right">10</td>
<td align="left">TestWFPProjects</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="left">2019-04-25 16:09:51</td>
<td align="left">NA</td>
<td align="left">NA</td>
<td align="left">FALSE</td>
</tr>
<tr class="even">
<td align="right">28</td>
<td align="left">Tom Test</td>
<td align="right">2</td>
<td align="right">1</td>
<td align="left">2019-07-31 20:08:20</td>
<td align="left">NA</td>
<td align="left">2019-07-31 20:45:47</td>
<td align="left">FALSE</td>
</tr>
<tr class="odd">
<td align="right">12</td>
<td align="left">UDA</td>
<td align="right">3</td>
<td align="right">2</td>
<td align="left">2019-05-02 14:52:35</td>
<td align="left">NA</td>
<td align="left">2019-10-30 14:06:35</td>
<td align="left">FALSE</td>
</tr>
<tr class="even">
<td align="right">20</td>
<td align="left">UNCP-MW Test</td>
<td align="right">2</td>
<td align="right">2</td>
<td align="left">2019-06-05 14:01:06</td>
<td align="left">NA</td>
<td align="left">2019-06-06 00:36:20</td>
<td align="left">FALSE</td>
</tr>
<tr class="odd">
<td align="right">55</td>
<td align="left">VL Cascade</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="left">2019-11-25 22:56:29</td>
<td align="left">NA</td>
<td align="left">NA</td>
<td align="left">FALSE</td>
</tr>
<tr class="even">
<td align="right">36</td>
<td align="left">Yaw’s test</td>
<td align="right">2</td>
<td align="right">1</td>
<td align="left">2019-09-02 22:59:35</td>
<td align="left">NA</td>
<td align="left">NA</td>
<td align="left">FALSE</td>
</tr>
<tr class="odd">
<td align="right">31</td>
<td align="left">Collect3289</td>
<td align="right">0</td>
<td align="right">1</td>
<td align="left">2019-08-07 12:39:42</td>
<td align="left">NA</td>
<td align="left">NA</td>
<td align="left">TRUE</td>
</tr>
<tr class="even">
<td align="right">17</td>
<td align="left">sdf</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="left">2019-05-24 12:21:59</td>
<td align="left">NA</td>
<td align="left">NA</td>
<td align="left">TRUE</td>
</tr>
<tr class="odd">
<td align="right">15</td>
<td align="left">Turtles</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="left">2019-05-17 08:18:39</td>
<td align="left">NA</td>
<td align="left">NA</td>
<td align="left">TRUE</td>
</tr>
<tr class="even">
<td align="right">19</td>
<td align="left">WatermelonPatch</td>
<td align="right">1</td>
<td align="right">1</td>
<td align="left">2019-05-29 19:44:14</td>
<td align="left">NA</td>
<td align="left">2019-05-29 19:50:50</td>
<td align="left">TRUE</td>
</tr>
</tbody>
</table>
<p>Inspect a project using its ID. We receive a tibble with exactly one row, all the columns of <code><a href="../reference/project_list.html">ruODK::project_list</a></code> plus a column <code>verbs</code>, which contains all available API actions for a project.</p>
<div class="sourceCode" id="cb4"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb4-1" title="1">fq_project_detail &lt;-<span class="st"> </span>ruODK<span class="op">::</span><span class="kw"><a href="https://rdrr.io/pkg/ruODK/man/project_detail.html">project_detail</a></span>()</a></code></pre></div>
<div class="sourceCode" id="cb5"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb5-1" title="1"><span class="co"># Project details (without verbs)</span></a>
<a class="sourceLine" id="cb5-2" title="2">fq_project_detail <span class="op">%&gt;%</span><span class="st"> </span>dplyr<span class="op">::</span><span class="kw"><a href="https://dplyr.tidyverse.org/reference/select.html">select</a></span>(<span class="op">-</span><span class="st">"verbs"</span>) <span class="op">%&gt;%</span><span class="st">  </span>knitr<span class="op">::</span><span class="kw"><a href="https://rdrr.io/pkg/knitr/man/kable.html">kable</a></span>(.)</a></code></pre></div>
<table class="table">
<thead><tr class="header">
<th align="right">id</th>
<th align="left">name</th>
<th align="right">forms</th>
<th align="right">app_users</th>
<th align="left">last_submission</th>
<th align="left">created_at</th>
<th align="left">updated_at</th>
<th align="left">archived</th>
</tr></thead>
<tbody><tr class="odd">
<td align="right">14</td>
<td align="left">ruODK package test forms</td>
<td align="right">9</td>
<td align="right">3</td>
<td align="left">2019-12-03T07:26:14.344Z</td>
<td align="left">2019-05-17T03:10:51.069Z</td>
<td align="left">2019-10-09T04:05:56.689Z</td>
<td align="left">FALSE</td>
</tr></tbody>
</table>
<div class="sourceCode" id="cb6"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb6-1" title="1"></a>
<a class="sourceLine" id="cb6-2" title="2"><span class="co"># Available verbs</span></a>
<a class="sourceLine" id="cb6-3" title="3">fq_project_detail<span class="op">$</span>verbs[[<span class="dv">1</span>]] <span class="op">%&gt;%</span><span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/base/unlist.html">unlist</a></span>(.)</a>
<a class="sourceLine" id="cb6-4" title="4"><span class="co">#&gt;  [1] "backup.create"            "backup.terminate"        </span></a>
<a class="sourceLine" id="cb6-5" title="5"><span class="co">#&gt;  [3] "config.read"              "field_key.create"        </span></a>
<a class="sourceLine" id="cb6-6" title="6"><span class="co">#&gt;  [5] "field_key.delete"         "field_key.list"          </span></a>
<a class="sourceLine" id="cb6-7" title="7"><span class="co">#&gt;  [7] "form.create"              "form.delete"             </span></a>
<a class="sourceLine" id="cb6-8" title="8"><span class="co">#&gt;  [9] "form.list"                "form.read"               </span></a>
<a class="sourceLine" id="cb6-9" title="9"><span class="co">#&gt; [11] "form.update"              "project.create"          </span></a>
<a class="sourceLine" id="cb6-10" title="10"><span class="co">#&gt; [13] "project.delete"           "project.list"            </span></a>
<a class="sourceLine" id="cb6-11" title="11"><span class="co">#&gt; [15] "project.read"             "project.update"          </span></a>
<a class="sourceLine" id="cb6-12" title="12"><span class="co">#&gt; [17] "session.end"              "submission.create"       </span></a>
<a class="sourceLine" id="cb6-13" title="13"><span class="co">#&gt; [19] "submission.read"          "submission.list"         </span></a>
<a class="sourceLine" id="cb6-14" title="14"><span class="co">#&gt; [21] "user.create"              "user.list"               </span></a>
<a class="sourceLine" id="cb6-15" title="15"><span class="co">#&gt; [23] "user.password.invalidate" "user.read"               </span></a>
<a class="sourceLine" id="cb6-16" title="16"><span class="co">#&gt; [25] "user.update"              "submission.update"       </span></a>
<a class="sourceLine" id="cb6-17" title="17"><span class="co">#&gt; [27] "role.create"              "role.update"             </span></a>
<a class="sourceLine" id="cb6-18" title="18"><span class="co">#&gt; [29] "role.delete"              "assignment.list"         </span></a>
<a class="sourceLine" id="cb6-19" title="19"><span class="co">#&gt; [31] "assignment.create"        "assignment.delete"       </span></a>
<a class="sourceLine" id="cb6-20" title="20"><span class="co">#&gt; [33] "user.delete"              "audit.read"</span></a></code></pre></div>
<p>Nothing apart from the verbs is new compared to the data returned by <code><a href="../reference/project_list.html">ruODK::project_list</a></code>.</p>
<p>To learn more about the functionality behind the verbs, refer to the interactive <a href="https://odkcentral.docs.apiary.io/#reference/project-management">ODK Central API documentation</a>.</p>
<p>To retrieve data from ODK Central, the functions shown below will suffice.</p>
</div>
<div id="forms" class="section level1">
<h1 class="hasAnchor">
<a href="#forms" class="anchor"></a>Forms</h1>
<div id="list-forms-for-a-project" class="section level2">
<h2 class="hasAnchor">
<a href="#list-forms-for-a-project" class="anchor"></a>List forms for a project</h2>
<p>To download form submissions, we need to know project ID and form ID.</p>
<p>There are several ways of retrieving the form ID:</p>
<ul>
<li>Browsing forms in the ODK Central’s project overviews,</li>
<li>Stealing the form ID from the OData service endpoint URL as shown on ODK Central’s form submission page,</li>
<li>Listing form metadata for a given project ID with <code><a href="../reference/form_list.html">ruODK::form_list()</a></code>.</li>
</ul>
<div class="sourceCode" id="cb7"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb7-1" title="1">fq_form_list &lt;-<span class="st"> </span>ruODK<span class="op">::</span><span class="kw"><a href="https://rdrr.io/pkg/ruODK/man/form_list.html">form_list</a></span>()</a></code></pre></div>
<div class="sourceCode" id="cb8"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb8-1" title="1">fq_form_list <span class="op">%&gt;%</span><span class="st"> </span>knitr<span class="op">::</span><span class="kw"><a href="https://rdrr.io/pkg/knitr/man/kable.html">kable</a></span>(.)</a></code></pre></div>
<table class="table">
<thead><tr class="header">
<th align="left">name</th>
<th align="left">fid</th>
<th align="left">version</th>
<th align="left">state</th>
<th align="left">submissions</th>
<th align="left">created_at</th>
<th align="right">created_by_id</th>
<th align="left">created_by</th>
<th align="left">updated_at</th>
<th align="left">last_submission</th>
<th align="left">hash</th>
</tr></thead>
<tbody>
<tr class="odd">
<td align="left">Flora Quadrat 0.1</td>
<td align="left">build_Flora-Quadrat-0-1_1558330379</td>
<td align="left"></td>
<td align="left">closing</td>
<td align="left">1</td>
<td align="left">2019-05-20 05:33:15</td>
<td align="right">57</td>
<td align="left"><a href="mailto:florian.mayer@dbca.wa.gov.au" class="email">florian.mayer@dbca.wa.gov.au</a></td>
<td align="left">2019-05-23 01:46:39</td>
<td align="left">2019-05-20 05:44:20</td>
<td align="left">4f0036619468ef05b572631b04b94f06</td>
</tr>
<tr class="even">
<td align="left">Flora Quadrat 0.2</td>
<td align="left">build_Flora-Quadrat-0-2_1558575936</td>
<td align="left"></td>
<td align="left">open</td>
<td align="left">2</td>
<td align="left">2019-05-23 01:46:08</td>
<td align="right">57</td>
<td align="left"><a href="mailto:florian.mayer@dbca.wa.gov.au" class="email">florian.mayer@dbca.wa.gov.au</a></td>
<td align="left">2019-08-19 07:57:38</td>
<td align="left">2019-05-23 03:12:16</td>
<td align="left">14e269a2374132392c275117efbe67b6</td>
</tr>
<tr class="odd">
<td align="left">Flora Quadrat 0.3</td>
<td align="left">build_Flora-Quadrat-0-3_1559119570</td>
<td align="left"></td>
<td align="left">open</td>
<td align="left">1</td>
<td align="left">2019-05-29 08:48:15</td>
<td align="right">57</td>
<td align="left"><a href="mailto:florian.mayer@dbca.wa.gov.au" class="email">florian.mayer@dbca.wa.gov.au</a></td>
<td align="left">NA</td>
<td align="left">2019-05-29 08:55:59</td>
<td align="left">d5a80cefb1895eefcd0cb86a12d8acb4</td>
</tr>
<tr class="even">
<td align="left">Flora Quadrat 0.4</td>
<td align="left">build_Flora-Quadrat-0-4_1564384341</td>
<td align="left"></td>
<td align="left">open</td>
<td align="left">2</td>
<td align="left">2019-08-19 07:58:28</td>
<td align="right">57</td>
<td align="left"><a href="mailto:florian.mayer@dbca.wa.gov.au" class="email">florian.mayer@dbca.wa.gov.au</a></td>
<td align="left">NA</td>
<td align="left">2019-09-18 08:51:07</td>
<td align="left">1bb959d541ac6990e3f74893e38c855b</td>
</tr>
<tr class="odd">
<td align="left">Spotlighting 0.5</td>
<td align="left">build_Spotlighting-0-5_1558320001</td>
<td align="left"></td>
<td align="left">closing</td>
<td align="left">1</td>
<td align="left">2019-05-20 02:44:47</td>
<td align="right">57</td>
<td align="left"><a href="mailto:florian.mayer@dbca.wa.gov.au" class="email">florian.mayer@dbca.wa.gov.au</a></td>
<td align="left">2019-05-20 06:30:41</td>
<td align="left">2019-05-20 02:58:09</td>
<td align="left">3775dcdface98ba3a426739c494123f6</td>
</tr>
<tr class="even">
<td align="left">Spotlighting 0.6</td>
<td align="left">build_Spotlighting-0-6_1558333698</td>
<td align="left"></td>
<td align="left">open</td>
<td align="left">18</td>
<td align="left">2019-05-20 06:30:21</td>
<td align="right">57</td>
<td align="left"><a href="mailto:florian.mayer@dbca.wa.gov.au" class="email">florian.mayer@dbca.wa.gov.au</a></td>
<td align="left">NA</td>
<td align="left">2019-10-09 01:15:23</td>
<td align="left">456daaa9a4f96670e6eef3cf4a7dd0db</td>
</tr>
<tr class="odd">
<td align="left">Spotlighting Survey End 0.3</td>
<td align="left">build_Spotlighting-Survey-End-0-3_1558320208</td>
<td align="left"></td>
<td align="left">open</td>
<td align="left">3</td>
<td align="left">2019-05-20 02:44:38</td>
<td align="right">57</td>
<td align="left"><a href="mailto:florian.mayer@dbca.wa.gov.au" class="email">florian.mayer@dbca.wa.gov.au</a></td>
<td align="left">NA</td>
<td align="left">2019-10-09 02:43:40</td>
<td align="left">5fdfac8e773834b1267f7ca7e1c9a428</td>
</tr>
<tr class="even">
<td align="left">Spotlighting Survey Start 0.3</td>
<td align="left">build_Spotlighting-Survey-Start-0-3_1558320795</td>
<td align="left"></td>
<td align="left">open</td>
<td align="left">9</td>
<td align="left">2019-05-20 02:53:50</td>
<td align="right">57</td>
<td align="left"><a href="mailto:florian.mayer@dbca.wa.gov.au" class="email">florian.mayer@dbca.wa.gov.au</a></td>
<td align="left">NA</td>
<td align="left">2019-10-09 01:15:25</td>
<td align="left">f548a064cca13bca746f3c0b1a8b5a32</td>
</tr>
<tr class="odd">
<td align="left">Turtle Track or Nest 1.0</td>
<td align="left">build_Turtle-Track-or-Nest-1-0_1569907666</td>
<td align="left"></td>
<td align="left">open</td>
<td align="left">2</td>
<td align="left">2019-12-03 07:16:51</td>
<td align="right">57</td>
<td align="left"><a href="mailto:florian.mayer@dbca.wa.gov.au" class="email">florian.mayer@dbca.wa.gov.au</a></td>
<td align="left">NA</td>
<td align="left">2019-12-03 07:26:14</td>
<td align="left">0b3b5e07e3f24f3a36afc92296693ec4</td>
</tr>
</tbody>
</table>
<p>Further to the metadata shown here, a column <code>xml</code> contains the entire XForms definition (originally XML) as nested list.</p>
<p>If the original XML is needed rather than the R equivalent (nested list), we can use <code><a href="../reference/form_xml.html">ruODK::form_xml</a></code> with parameter <code>parse=FALSE</code>:</p>
<div class="sourceCode" id="cb9"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb9-1" title="1">fq_form_xml &lt;-<span class="st"> </span>ruODK<span class="op">::</span><span class="kw"><a href="https://rdrr.io/pkg/ruODK/man/form_xml.html">form_xml</a></span>(<span class="dt">parse=</span><span class="ot">FALSE</span>)</a></code></pre></div>
<div class="sourceCode" id="cb10"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb10-1" title="1">fq_form_xml</a>
<a class="sourceLine" id="cb10-2" title="2"><span class="co">#&gt; $node</span></a>
<a class="sourceLine" id="cb10-3" title="3"><span class="co">#&gt; &lt;pointer: (nil)&gt;</span></a>
<a class="sourceLine" id="cb10-4" title="4"><span class="co">#&gt; </span></a>
<a class="sourceLine" id="cb10-5" title="5"><span class="co">#&gt; $doc</span></a>
<a class="sourceLine" id="cb10-6" title="6"><span class="co">#&gt; &lt;pointer: (nil)&gt;</span></a>
<a class="sourceLine" id="cb10-7" title="7"><span class="co">#&gt; </span></a>
<a class="sourceLine" id="cb10-8" title="8"><span class="co">#&gt; attr(,"class")</span></a>
<a class="sourceLine" id="cb10-9" title="9"><span class="co">#&gt; [1] "xml_document" "xml_node"</span></a></code></pre></div>
</div>
<div id="inspect-form-schema" class="section level2">
<h2 class="hasAnchor">
<a href="#inspect-form-schema" class="anchor"></a>Inspect form schema</h2>
<p>The nested list of lists returned by <code>form_schema</code> is the cleanest representation of the XForm definition available in R.</p>
<p>See the <a href="https://odkcentral.docs.apiary.io/#reference/forms-and-submissions/'-individual-form/retrieving-form-schema-json">ODK Central API docs</a> and the examples of <code>??ruODK::form_schema()</code> for more detail.</p>
<div class="sourceCode" id="cb11"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb11-1" title="1">fq_form_schema_raw &lt;-<span class="st"> </span>ruODK<span class="op">::</span><span class="kw"><a href="https://rdrr.io/pkg/ruODK/man/form_schema.html">form_schema</a></span>(<span class="dt">parse=</span><span class="ot">FALSE</span>)</a></code></pre></div>
<div class="sourceCode" id="cb12"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb12-1" title="1">listviewer<span class="op">::</span><span class="kw"><a href="https://rdrr.io/pkg/listviewer/man/jsonedit.html">jsonedit</a></span>(fq_form_schema_raw, <span class="dt">mode=</span><span class="st">"code"</span>)</a></code></pre></div>
<div id="htmlwidget-be88f840ed8d455d3e32" style="width:672px;height:432.632880098888px;" class="jsonedit html-widget"></div>
<script type="application/json" data-for="htmlwidget-be88f840ed8d455d3e32">{"x":{"data":[{"name":"meta","children":[{"name":"instanceID","type":"string"}],"type":"structure"},{"name":"encounter_start_datetime","type":"dateTime"},{"name":"reporter","type":"string"},{"name":"device_id","type":"string"},{"name":"location","children":[{"name":"area_name","type":"string"},{"name":"quadrat_photo","type":"binary"},{"name":"corner1","type":"geopoint"}],"type":"structure"},{"name":"habitat","children":[{"name":"morphological_type","type":"select1"},{"name":"morphological_type_photo","type":"binary"}],"type":"structure"},{"name":"vegetation_stratum","children":[{"name":"nvis_level3_broad_floristic_group","type":"select1"},{"name":"max_height_m","type":"decimal"},{"name":"foliage_cover","type":"select1"},{"name":"dominant_species_1","type":"string"},{"name":"dominant_species_2","type":"string"},{"name":"dominant_species_3","type":"string"},{"name":"dominant_species_4","type":"string"}],"type":"repeat"},{"name":"perimeter","children":[{"name":"corner2","type":"geopoint"},{"name":"corner3","type":"geopoint"},{"name":"corner4","type":"geopoint"},{"name":"mudmap_photo","type":"binary"}],"type":"structure"},{"name":"taxon_encounter","children":[{"name":"field_name","type":"string"},{"name":"photo_in_situ","type":"binary"},{"name":"taxon_encounter_location","type":"geopoint"},{"name":"life_form","type":"select1"},{"name":"voucher_specimen_barcode","type":"barcode"},{"name":"voucher_specimen_label","type":"string"}],"type":"repeat"},{"name":"encounter_end_datetime","type":"dateTime"}],"options":{"mode":"code","modes":["code","form","text","tree","view"]}},"evals":[],"jsHooks":[]}</script><p>The form schema tells us about form field data types (e.g. dates, geopoints, binary attachments) and repeating groups. We need this knowledge to parse the submission data into tidy tibbles later.</p>
<p>Feel free to search this list for “binary” to find the field names of file attachments. Similarly, search for “dateTime” to find field names of datetimes.</p>
<p>Taking form schema one step further, we can also parse it into a <code>tibble</code> of form field types and names.</p>
<div class="sourceCode" id="cb13"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb13-1" title="1">fq_form_schema &lt;-<span class="st"> </span>ruODK<span class="op">::</span><span class="kw"><a href="https://rdrr.io/pkg/ruODK/man/form_schema.html">form_schema</a></span>(<span class="dt">parse=</span><span class="ot">TRUE</span>)</a></code></pre></div>
<div class="sourceCode" id="cb14"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb14-1" title="1">fq_form_schema <span class="op">%&gt;%</span><span class="st"> </span>knitr<span class="op">::</span><span class="kw"><a href="https://rdrr.io/pkg/knitr/man/kable.html">kable</a></span>(.)</a></code></pre></div>
<table class="table">
<thead><tr class="header">
<th align="left">type</th>
<th align="left">name</th>
<th align="left">path</th>
</tr></thead>
<tbody>
<tr class="odd">
<td align="left">structure</td>
<td align="left">meta</td>
<td align="left">Submissions</td>
</tr>
<tr class="even">
<td align="left">dateTime</td>
<td align="left">encounter_start_datetime</td>
<td align="left">Submissions</td>
</tr>
<tr class="odd">
<td align="left">string</td>
<td align="left">reporter</td>
<td align="left">Submissions</td>
</tr>
<tr class="even">
<td align="left">string</td>
<td align="left">device_id</td>
<td align="left">Submissions</td>
</tr>
<tr class="odd">
<td align="left">structure</td>
<td align="left">location</td>
<td align="left">Submissions</td>
</tr>
<tr class="even">
<td align="left">structure</td>
<td align="left">habitat</td>
<td align="left">Submissions</td>
</tr>
<tr class="odd">
<td align="left">repeat</td>
<td align="left">vegetation_stratum</td>
<td align="left">Submissions</td>
</tr>
<tr class="even">
<td align="left">structure</td>
<td align="left">perimeter</td>
<td align="left">Submissions</td>
</tr>
<tr class="odd">
<td align="left">repeat</td>
<td align="left">taxon_encounter</td>
<td align="left">Submissions</td>
</tr>
<tr class="even">
<td align="left">dateTime</td>
<td align="left">encounter_end_datetime</td>
<td align="left">Submissions</td>
</tr>
<tr class="odd">
<td align="left">string</td>
<td align="left">instanceID</td>
<td align="left">Submissions.meta</td>
</tr>
<tr class="even">
<td align="left">string</td>
<td align="left">area_name</td>
<td align="left">Submissions.location</td>
</tr>
<tr class="odd">
<td align="left">binary</td>
<td align="left">quadrat_photo</td>
<td align="left">Submissions.location</td>
</tr>
<tr class="even">
<td align="left">geopoint</td>
<td align="left">corner1</td>
<td align="left">Submissions.location</td>
</tr>
<tr class="odd">
<td align="left">select1</td>
<td align="left">morphological_type</td>
<td align="left">Submissions.habitat</td>
</tr>
<tr class="even">
<td align="left">binary</td>
<td align="left">morphological_type_photo</td>
<td align="left">Submissions.habitat</td>
</tr>
<tr class="odd">
<td align="left">select1</td>
<td align="left">nvis_level3_broad_floristic_group</td>
<td align="left">Submissions.vegetation_stratum</td>
</tr>
<tr class="even">
<td align="left">decimal</td>
<td align="left">max_height_m</td>
<td align="left">Submissions.vegetation_stratum</td>
</tr>
<tr class="odd">
<td align="left">select1</td>
<td align="left">foliage_cover</td>
<td align="left">Submissions.vegetation_stratum</td>
</tr>
<tr class="even">
<td align="left">string</td>
<td align="left">dominant_species_1</td>
<td align="left">Submissions.vegetation_stratum</td>
</tr>
<tr class="odd">
<td align="left">string</td>
<td align="left">dominant_species_2</td>
<td align="left">Submissions.vegetation_stratum</td>
</tr>
<tr class="even">
<td align="left">string</td>
<td align="left">dominant_species_3</td>
<td align="left">Submissions.vegetation_stratum</td>
</tr>
<tr class="odd">
<td align="left">string</td>
<td align="left">dominant_species_4</td>
<td align="left">Submissions.vegetation_stratum</td>
</tr>
<tr class="even">
<td align="left">geopoint</td>
<td align="left">corner2</td>
<td align="left">Submissions.perimeter</td>
</tr>
<tr class="odd">
<td align="left">geopoint</td>
<td align="left">corner3</td>
<td align="left">Submissions.perimeter</td>
</tr>
<tr class="even">
<td align="left">geopoint</td>
<td align="left">corner4</td>
<td align="left">Submissions.perimeter</td>
</tr>
<tr class="odd">
<td align="left">binary</td>
<td align="left">mudmap_photo</td>
<td align="left">Submissions.perimeter</td>
</tr>
<tr class="even">
<td align="left">string</td>
<td align="left">field_name</td>
<td align="left">Submissions.taxon_encounter</td>
</tr>
<tr class="odd">
<td align="left">binary</td>
<td align="left">photo_in_situ</td>
<td align="left">Submissions.taxon_encounter</td>
</tr>
<tr class="even">
<td align="left">geopoint</td>
<td align="left">taxon_encounter_location</td>
<td align="left">Submissions.taxon_encounter</td>
</tr>
<tr class="odd">
<td align="left">select1</td>
<td align="left">life_form</td>
<td align="left">Submissions.taxon_encounter</td>
</tr>
<tr class="even">
<td align="left">barcode</td>
<td align="left">voucher_specimen_barcode</td>
<td align="left">Submissions.taxon_encounter</td>
</tr>
<tr class="odd">
<td align="left">string</td>
<td align="left">voucher_specimen_label</td>
<td align="left">Submissions.taxon_encounter</td>
</tr>
</tbody>
</table>
</div>
<div id="show-details-of-one-form" class="section level2">
<h2 class="hasAnchor">
<a href="#show-details-of-one-form" class="anchor"></a>Show details of one form</h2>
<p>The details of a form are exactly the same as the output of <code><a href="../reference/form_list.html">ruODK::form_list()</a></code>.</p>
<div class="sourceCode" id="cb15"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb15-1" title="1">fq_form_detail &lt;-<span class="st"> </span>ruODK<span class="op">::</span><span class="kw"><a href="https://rdrr.io/pkg/ruODK/man/form_detail.html">form_detail</a></span>()</a></code></pre></div>
<div class="sourceCode" id="cb16"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb16-1" title="1">fq_form_detail <span class="op">%&gt;%</span><span class="st"> </span>knitr<span class="op">::</span><span class="kw"><a href="https://rdrr.io/pkg/knitr/man/kable.html">kable</a></span>(.)</a></code></pre></div>
<table class="table">
<thead><tr class="header">
<th align="left">name</th>
<th align="left">fid</th>
<th align="left">version</th>
<th align="left">state</th>
<th align="right">submissions</th>
<th align="left">created_at</th>
<th align="right">created_by_id</th>
<th align="left">created_by</th>
<th align="left">updated_at</th>
<th align="left">last_submission</th>
<th align="left">hash</th>
</tr></thead>
<tbody><tr class="odd">
<td align="left">Flora Quadrat 0.4</td>
<td align="left">build_Flora-Quadrat-0-4_1564384341</td>
<td align="left"></td>
<td align="left">open</td>
<td align="right">2</td>
<td align="left">2019-08-19T07:58:28.211Z</td>
<td align="right">57</td>
<td align="left"><a href="mailto:florian.mayer@dbca.wa.gov.au" class="email">florian.mayer@dbca.wa.gov.au</a></td>
<td align="left">NA</td>
<td align="left">2019-09-18T08:51:07.481Z</td>
<td align="left">1bb959d541ac6990e3f74893e38c855b</td>
</tr></tbody>
</table>
</div>
</div>
<div id="submissions" class="section level1">
<h1 class="hasAnchor">
<a href="#submissions" class="anchor"></a>Submissions</h1>
<p>We are getting closer to the actual data! This section shows two of the options for data access: dump all submissions, or extract a subset.</p>
<div id="get-all-submissions-for-one-form" class="section level2">
<h2 class="hasAnchor">
<a href="#get-all-submissions-for-one-form" class="anchor"></a>Get all submissions for one form</h2>
<p>Smaller datasets lend themselves to be exported in one go. ODK Central offers one giant zip file containing all submissions, any repeating groups, and any attachments both on the form submission page, and as API endpoint which is provided as <code><a href="../reference/submission_export.html">ruODK::submission_export()</a></code>.</p>
<p>The default behaviour of <code><a href="../reference/submission_export.html">ruODK::submission_export()</a></code> is to write the zip file to the project root (<code><a href="https://rdrr.io/pkg/here/man/here.html">here::here()</a></code>), and to overwrite existing previous downloads. See <code>?ruODK::submission_export()</code> for alternative download and retention options.</p>
<p>In the following chuck, we illustrate common tasks:</p>
<ul>
<li>Download the zip file.</li>
<li>Unpack the zip file.</li>
<li>Join repeating form group data <code>data_taxon</code> to main data <code>data_quadrat</code> to annotate <code>data_taxon</code> with data from <code>data_quadrat</code>.</li>
<li>Sanitise the column names.</li>
<li>Prepend all attachment filenames (e.g. <code>data_quadrat$location_quadrat_photo</code>, <code>data_taxon$photo_in_situ</code>) with <code>media/</code>.</li>
</ul>
<div class="sourceCode" id="cb17"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb17-1" title="1">t &lt;-<span class="st"> </span>fs<span class="op">::</span><span class="kw"><a href="http://fs.r-lib.org/reference/create.html">dir_create</a></span>(<span class="st">"attachments"</span>)</a>
<a class="sourceLine" id="cb17-2" title="2"></a>
<a class="sourceLine" id="cb17-3" title="3"><span class="co"># Predict filenames (with knowledge of form)</span></a>
<a class="sourceLine" id="cb17-4" title="4">fid &lt;-<span class="st"> </span>ruODK<span class="op">::</span><span class="kw"><a href="https://rdrr.io/pkg/ruODK/man/ru_settings.html">get_test_fid</a></span>()</a>
<a class="sourceLine" id="cb17-5" title="5">fid_csv &lt;-<span class="st"> </span>fs<span class="op">::</span><span class="kw"><a href="http://fs.r-lib.org/reference/path.html">path</a></span>(t, glue<span class="op">::</span><span class="kw"><a href="https://rdrr.io/pkg/glue/man/glue.html">glue</a></span>(<span class="st">"{fid}.csv"</span>))</a>
<a class="sourceLine" id="cb17-6" title="6">fid_csv_veg &lt;-<span class="st"> </span>fs<span class="op">::</span><span class="kw"><a href="http://fs.r-lib.org/reference/path.html">path</a></span>(t, glue<span class="op">::</span><span class="kw"><a href="https://rdrr.io/pkg/glue/man/glue.html">glue</a></span>(<span class="st">"{fid}-vegetation_stratum.csv"</span>))</a>
<a class="sourceLine" id="cb17-7" title="7">fid_csv_tae &lt;-<span class="st"> </span>fs<span class="op">::</span><span class="kw"><a href="http://fs.r-lib.org/reference/path.html">path</a></span>(t, glue<span class="op">::</span><span class="kw"><a href="https://rdrr.io/pkg/glue/man/glue.html">glue</a></span>(<span class="st">"{fid}-taxon_encounter.csv"</span>))</a>
<a class="sourceLine" id="cb17-8" title="8"></a>
<a class="sourceLine" id="cb17-9" title="9"><span class="co"># Download the zip file</span></a>
<a class="sourceLine" id="cb17-10" title="10">se &lt;-<span class="st"> </span>ruODK<span class="op">::</span><span class="kw"><a href="https://rdrr.io/pkg/ruODK/man/submission_export.html">submission_export</a></span>(<span class="dt">local_dir =</span> t, <span class="dt">overwrite =</span> <span class="ot">FALSE</span>, <span class="dt">verbose =</span> <span class="ot">TRUE</span>)</a>
<a class="sourceLine" id="cb17-11" title="11"></a>
<a class="sourceLine" id="cb17-12" title="12"><span class="co"># Unpack the zip file</span></a>
<a class="sourceLine" id="cb17-13" title="13">f &lt;-<span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/utils/unzip.html">unzip</a></span>(se, <span class="dt">exdir =</span> t)</a>
<a class="sourceLine" id="cb17-14" title="14">fs<span class="op">::</span><span class="kw"><a href="http://fs.r-lib.org/reference/dir_ls.html">dir_ls</a></span>(t)</a>
<a class="sourceLine" id="cb17-15" title="15"></a>
<a class="sourceLine" id="cb17-16" title="16"><span class="co"># Prepend attachments with media/ to turn into relative file paths</span></a>
<a class="sourceLine" id="cb17-17" title="17">fq_zip_data &lt;-<span class="st"> </span>fid_csv <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb17-18" title="18"><span class="st">  </span>readr<span class="op">::</span><span class="kw"><a href="https://readr.tidyverse.org/reference/read_delim.html">read_csv</a></span>(<span class="dt">na =</span> <span class="kw"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="st">""</span>, <span class="st">"NA"</span>, <span class="st">"na"</span>)) <span class="op">%&gt;%</span><span class="st"> </span><span class="co"># form uses "na" for NA</span></a>
<a class="sourceLine" id="cb17-19" title="19"><span class="st">  </span>janitor<span class="op">::</span><span class="kw"><a href="https://rdrr.io/pkg/janitor/man/clean_names.html">clean_names</a></span>(.) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb17-20" title="20"><span class="st">  </span><span class="kw"><a href="../reference/attachment_link.html">attachment_link</a></span>(.) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb17-21" title="21"><span class="st">  </span><span class="kw"><a href="../reference/ru_datetime.html">ru_datetime</a></span>(<span class="dt">tz =</span> <span class="st">"Australia/Perth"</span>)      <span class="co"># an example timezone</span></a>
<a class="sourceLine" id="cb17-22" title="22"></a>
<a class="sourceLine" id="cb17-23" title="23">fq_zip_strata &lt;-<span class="st"> </span>fid_csv_veg <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb17-24" title="24"><span class="st">  </span>readr<span class="op">::</span><span class="kw"><a href="https://readr.tidyverse.org/reference/read_delim.html">read_csv</a></span>(<span class="dt">na =</span> <span class="kw"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="st">""</span>, <span class="st">"NA"</span>, <span class="st">"na"</span>)) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb17-25" title="25"><span class="st">  </span>janitor<span class="op">::</span><span class="kw"><a href="https://rdrr.io/pkg/janitor/man/clean_names.html">clean_names</a></span>(.) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb17-26" title="26"><span class="st">  </span><span class="kw"><a href="../reference/attachment_link.html">attachment_link</a></span>(.) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb17-27" title="27"><span class="st">  </span><span class="kw"><a href="../reference/ru_datetime.html">ru_datetime</a></span>(<span class="dt">tz =</span> <span class="st">"Australia/Perth"</span>) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb17-28" title="28"><span class="st">  </span>dplyr<span class="op">::</span><span class="kw"><a href="https://dplyr.tidyverse.org/reference/join.html">left_join</a></span>(data_quadrat, <span class="dt">by =</span> <span class="kw"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="st">"parent_key"</span> =<span class="st"> "meta_instance_id"</span>))</a>
<a class="sourceLine" id="cb17-29" title="29"></a>
<a class="sourceLine" id="cb17-30" title="30">fq_zip_taxa &lt;-<span class="st"> </span>fid_csv_tae <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb17-31" title="31"><span class="st">  </span>readr<span class="op">::</span><span class="kw"><a href="https://readr.tidyverse.org/reference/read_delim.html">read_csv</a></span>(<span class="dt">na =</span> <span class="kw"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="st">""</span>, <span class="st">"NA"</span>, <span class="st">"na"</span>)) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb17-32" title="32"><span class="st">  </span>janitor<span class="op">::</span><span class="kw"><a href="https://rdrr.io/pkg/janitor/man/clean_names.html">clean_names</a></span>(.) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb17-33" title="33"><span class="st">  </span><span class="kw"><a href="../reference/attachment_link.html">attachment_link</a></span>(.) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb17-34" title="34"><span class="st">  </span><span class="kw"><a href="../reference/ru_datetime.html">ru_datetime</a></span>(<span class="dt">tz =</span> <span class="st">"Australia/Perth"</span>) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb17-35" title="35"><span class="st">  </span>dplyr<span class="op">::</span><span class="kw"><a href="https://dplyr.tidyverse.org/reference/join.html">left_join</a></span>(data_quadrat, <span class="dt">by =</span> <span class="kw"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="st">"parent_key"</span> =<span class="st"> "meta_instance_id"</span>))</a></code></pre></div>
<div class="sourceCode" id="cb18"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb18-1" title="1"><span class="kw"><a href="https://rdrr.io/r/utils/head.html">head</a></span>(fq_zip_data)</a>
<a class="sourceLine" id="cb18-2" title="2"><span class="co">#&gt; # A tibble: 2 x 33</span></a>
<a class="sourceLine" id="cb18-3" title="3"><span class="co">#&gt;   submission_date     meta_instance_id encounter_start_da… reporter device_id</span></a>
<a class="sourceLine" id="cb18-4" title="4"><span class="co">#&gt;   &lt;dttm&gt;              &lt;chr&gt;            &lt;dttm&gt;              &lt;chr&gt;    &lt;chr&gt;    </span></a>
<a class="sourceLine" id="cb18-5" title="5"><span class="co">#&gt; 1 2019-09-18 08:51:07 uuid:d5e78a78-3… 2019-09-18 16:12:21 Florian… f73d2e12…</span></a>
<a class="sourceLine" id="cb18-6" title="6"><span class="co">#&gt; 2 2019-09-18 06:20:25 uuid:529cb189-8… 2019-09-18 14:08:43 Florian… f73d2e12…</span></a>
<a class="sourceLine" id="cb18-7" title="7"><span class="co">#&gt; # … with 28 more variables: location_area_name &lt;chr&gt;,</span></a>
<a class="sourceLine" id="cb18-8" title="8"><span class="co">#&gt; #   location_quadrat_photo &lt;fs::path&gt;, location_corner1_latitude &lt;dbl&gt;,</span></a>
<a class="sourceLine" id="cb18-9" title="9"><span class="co">#&gt; #   location_corner1_longitude &lt;dbl&gt;, location_corner1_altitude &lt;dbl&gt;,</span></a>
<a class="sourceLine" id="cb18-10" title="10"><span class="co">#&gt; #   location_corner1_accuracy &lt;dbl&gt;, habitat_morphological_type &lt;chr&gt;,</span></a>
<a class="sourceLine" id="cb18-11" title="11"><span class="co">#&gt; #   habitat_morphological_type_photo &lt;fs::path&gt;,</span></a>
<a class="sourceLine" id="cb18-12" title="12"><span class="co">#&gt; #   perimeter_corner2_latitude &lt;dbl&gt;, perimeter_corner2_longitude &lt;dbl&gt;,</span></a>
<a class="sourceLine" id="cb18-13" title="13"><span class="co">#&gt; #   perimeter_corner2_altitude &lt;dbl&gt;, perimeter_corner2_accuracy &lt;dbl&gt;,</span></a>
<a class="sourceLine" id="cb18-14" title="14"><span class="co">#&gt; #   perimeter_corner3_latitude &lt;dbl&gt;, perimeter_corner3_longitude &lt;dbl&gt;,</span></a>
<a class="sourceLine" id="cb18-15" title="15"><span class="co">#&gt; #   perimeter_corner3_altitude &lt;dbl&gt;, perimeter_corner3_accuracy &lt;dbl&gt;,</span></a>
<a class="sourceLine" id="cb18-16" title="16"><span class="co">#&gt; #   perimeter_corner4_latitude &lt;dbl&gt;, perimeter_corner4_longitude &lt;dbl&gt;,</span></a>
<a class="sourceLine" id="cb18-17" title="17"><span class="co">#&gt; #   perimeter_corner4_altitude &lt;dbl&gt;, perimeter_corner4_accuracy &lt;dbl&gt;,</span></a>
<a class="sourceLine" id="cb18-18" title="18"><span class="co">#&gt; #   perimeter_mudmap_photo &lt;fs::path&gt;, encounter_end_datetime &lt;dttm&gt;,</span></a>
<a class="sourceLine" id="cb18-19" title="19"><span class="co">#&gt; #   key &lt;chr&gt;, submitter_id &lt;dbl&gt;, submitter_name &lt;chr&gt;,</span></a>
<a class="sourceLine" id="cb18-20" title="20"><span class="co">#&gt; #   attachments_present &lt;dbl&gt;, attachments_expected &lt;dbl&gt;, status &lt;chr&gt;</span></a>
<a class="sourceLine" id="cb18-21" title="21"><span class="kw"><a href="https://rdrr.io/r/utils/head.html">head</a></span>(fq_zip_strata)</a>
<a class="sourceLine" id="cb18-22" title="22"><span class="co">#&gt; # A tibble: 6 x 41</span></a>
<a class="sourceLine" id="cb18-23" title="23"><span class="co">#&gt;   nvis_level3_bro… max_height_m foliage_cover dominant_specie… dominant_specie…</span></a>
<a class="sourceLine" id="cb18-24" title="24"><span class="co">#&gt;   &lt;chr&gt;                   &lt;dbl&gt; &lt;chr&gt;         &lt;chr&gt;            &lt;chr&gt;           </span></a>
<a class="sourceLine" id="cb18-25" title="25"><span class="co">#&gt; 1 w1.0_trees_with…         3    10-5          Euc big fruit    &lt;NA&gt;            </span></a>
<a class="sourceLine" id="cb18-26" title="26"><span class="co">#&gt; 2 w3.0_shrub               2    30-10         Blue bush        Xmas shrub      </span></a>
<a class="sourceLine" id="cb18-27" title="27"><span class="co">#&gt; 3 g4.0_sedge              NA    5-0           Tall spiky       &lt;NA&gt;            </span></a>
<a class="sourceLine" id="cb18-28" title="28"><span class="co">#&gt; 4 w3.0_shrub               0.5  30-10         Erem green frost Banks is candles</span></a>
<a class="sourceLine" id="cb18-29" title="29"><span class="co">#&gt; 5 m1.0_bryophyte           0.05 5-0           Moss town        &lt;NA&gt;            </span></a>
<a class="sourceLine" id="cb18-30" title="30"><span class="co">#&gt; 6 w3.0_shrub               3    5-0           Plant name 1     Plant name 2    </span></a>
<a class="sourceLine" id="cb18-31" title="31"><span class="co">#&gt; # … with 36 more variables: dominant_species_3 &lt;chr&gt;, dominant_species_4 &lt;chr&gt;,</span></a>
<a class="sourceLine" id="cb18-32" title="32"><span class="co">#&gt; #   parent_key &lt;chr&gt;, key.x &lt;chr&gt;, submission_date &lt;dttm&gt;,</span></a>
<a class="sourceLine" id="cb18-33" title="33"><span class="co">#&gt; #   encounter_start_datetime &lt;dttm&gt;, reporter &lt;chr&gt;, device_id &lt;chr&gt;,</span></a>
<a class="sourceLine" id="cb18-34" title="34"><span class="co">#&gt; #   location_area_name &lt;chr&gt;, location_quadrat_photo &lt;fs::path&gt;,</span></a>
<a class="sourceLine" id="cb18-35" title="35"><span class="co">#&gt; #   location_corner1_latitude &lt;dbl&gt;, location_corner1_longitude &lt;dbl&gt;,</span></a>
<a class="sourceLine" id="cb18-36" title="36"><span class="co">#&gt; #   location_corner1_altitude &lt;dbl&gt;, location_corner1_accuracy &lt;dbl&gt;,</span></a>
<a class="sourceLine" id="cb18-37" title="37"><span class="co">#&gt; #   habitat_morphological_type &lt;chr&gt;,</span></a>
<a class="sourceLine" id="cb18-38" title="38"><span class="co">#&gt; #   habitat_morphological_type_photo &lt;fs::path&gt;,</span></a>
<a class="sourceLine" id="cb18-39" title="39"><span class="co">#&gt; #   perimeter_corner2_latitude &lt;dbl&gt;, perimeter_corner2_longitude &lt;dbl&gt;,</span></a>
<a class="sourceLine" id="cb18-40" title="40"><span class="co">#&gt; #   perimeter_corner2_altitude &lt;dbl&gt;, perimeter_corner2_accuracy &lt;dbl&gt;,</span></a>
<a class="sourceLine" id="cb18-41" title="41"><span class="co">#&gt; #   perimeter_corner3_latitude &lt;dbl&gt;, perimeter_corner3_longitude &lt;dbl&gt;,</span></a>
<a class="sourceLine" id="cb18-42" title="42"><span class="co">#&gt; #   perimeter_corner3_altitude &lt;dbl&gt;, perimeter_corner3_accuracy &lt;dbl&gt;,</span></a>
<a class="sourceLine" id="cb18-43" title="43"><span class="co">#&gt; #   perimeter_corner4_latitude &lt;dbl&gt;, perimeter_corner4_longitude &lt;dbl&gt;,</span></a>
<a class="sourceLine" id="cb18-44" title="44"><span class="co">#&gt; #   perimeter_corner4_altitude &lt;dbl&gt;, perimeter_corner4_accuracy &lt;dbl&gt;,</span></a>
<a class="sourceLine" id="cb18-45" title="45"><span class="co">#&gt; #   perimeter_mudmap_photo &lt;fs::path&gt;, encounter_end_datetime &lt;dttm&gt;,</span></a>
<a class="sourceLine" id="cb18-46" title="46"><span class="co">#&gt; #   key.y &lt;chr&gt;, submitter_id &lt;dbl&gt;, submitter_name &lt;chr&gt;,</span></a>
<a class="sourceLine" id="cb18-47" title="47"><span class="co">#&gt; #   attachments_present &lt;dbl&gt;, attachments_expected &lt;dbl&gt;, status &lt;chr&gt;</span></a>
<a class="sourceLine" id="cb18-48" title="48"><span class="kw"><a href="https://rdrr.io/r/utils/head.html">head</a></span>(fq_zip_taxa)</a>
<a class="sourceLine" id="cb18-49" title="49"><span class="co">#&gt; # A tibble: 6 x 43</span></a>
<a class="sourceLine" id="cb18-50" title="50"><span class="co">#&gt;   field_name photo_in_situ taxon_encounter… taxon_encounter… taxon_encounter…</span></a>
<a class="sourceLine" id="cb18-51" title="51"><span class="co">#&gt;   &lt;chr&gt;      &lt;fs::path&gt;               &lt;dbl&gt;            &lt;dbl&gt;            &lt;dbl&gt;</span></a>
<a class="sourceLine" id="cb18-52" title="52"><span class="co">#&gt; 1 Conostyli… media/156879…            -32.0             116.          -25.6  </span></a>
<a class="sourceLine" id="cb18-53" title="53"><span class="co">#&gt; 2 Blue bush  media/156879…            -32.0             116.          -14.5  </span></a>
<a class="sourceLine" id="cb18-54" title="54"><span class="co">#&gt; 3 Pileanthu… media/156878…            -32.0             116.          -64.9  </span></a>
<a class="sourceLine" id="cb18-55" title="55"><span class="co">#&gt; 4 Small pin… media/156878…            -32.0             116.          -44.9  </span></a>
<a class="sourceLine" id="cb18-56" title="56"><span class="co">#&gt; 5 Small red… media/156878…            -32.0             116.           -0.859</span></a>
<a class="sourceLine" id="cb18-57" title="57"><span class="co">#&gt; 6 Funky gra… media/156878…            -32.0             116.           -9.49 </span></a>
<a class="sourceLine" id="cb18-58" title="58"><span class="co">#&gt; # … with 38 more variables: taxon_encounter_location_accuracy &lt;dbl&gt;,</span></a>
<a class="sourceLine" id="cb18-59" title="59"><span class="co">#&gt; #   life_form &lt;chr&gt;, voucher_specimen_barcode &lt;chr&gt;,</span></a>
<a class="sourceLine" id="cb18-60" title="60"><span class="co">#&gt; #   voucher_specimen_label &lt;chr&gt;, parent_key &lt;chr&gt;, key.x &lt;chr&gt;,</span></a>
<a class="sourceLine" id="cb18-61" title="61"><span class="co">#&gt; #   submission_date &lt;dttm&gt;, encounter_start_datetime &lt;dttm&gt;, reporter &lt;chr&gt;,</span></a>
<a class="sourceLine" id="cb18-62" title="62"><span class="co">#&gt; #   device_id &lt;chr&gt;, location_area_name &lt;chr&gt;,</span></a>
<a class="sourceLine" id="cb18-63" title="63"><span class="co">#&gt; #   location_quadrat_photo &lt;fs::path&gt;, location_corner1_latitude &lt;dbl&gt;,</span></a>
<a class="sourceLine" id="cb18-64" title="64"><span class="co">#&gt; #   location_corner1_longitude &lt;dbl&gt;, location_corner1_altitude &lt;dbl&gt;,</span></a>
<a class="sourceLine" id="cb18-65" title="65"><span class="co">#&gt; #   location_corner1_accuracy &lt;dbl&gt;, habitat_morphological_type &lt;chr&gt;,</span></a>
<a class="sourceLine" id="cb18-66" title="66"><span class="co">#&gt; #   habitat_morphological_type_photo &lt;fs::path&gt;,</span></a>
<a class="sourceLine" id="cb18-67" title="67"><span class="co">#&gt; #   perimeter_corner2_latitude &lt;dbl&gt;, perimeter_corner2_longitude &lt;dbl&gt;,</span></a>
<a class="sourceLine" id="cb18-68" title="68"><span class="co">#&gt; #   perimeter_corner2_altitude &lt;dbl&gt;, perimeter_corner2_accuracy &lt;dbl&gt;,</span></a>
<a class="sourceLine" id="cb18-69" title="69"><span class="co">#&gt; #   perimeter_corner3_latitude &lt;dbl&gt;, perimeter_corner3_longitude &lt;dbl&gt;,</span></a>
<a class="sourceLine" id="cb18-70" title="70"><span class="co">#&gt; #   perimeter_corner3_altitude &lt;dbl&gt;, perimeter_corner3_accuracy &lt;dbl&gt;,</span></a>
<a class="sourceLine" id="cb18-71" title="71"><span class="co">#&gt; #   perimeter_corner4_latitude &lt;dbl&gt;, perimeter_corner4_longitude &lt;dbl&gt;,</span></a>
<a class="sourceLine" id="cb18-72" title="72"><span class="co">#&gt; #   perimeter_corner4_altitude &lt;dbl&gt;, perimeter_corner4_accuracy &lt;dbl&gt;,</span></a>
<a class="sourceLine" id="cb18-73" title="73"><span class="co">#&gt; #   perimeter_mudmap_photo &lt;fs::path&gt;, encounter_end_datetime &lt;dttm&gt;,</span></a>
<a class="sourceLine" id="cb18-74" title="74"><span class="co">#&gt; #   key.y &lt;chr&gt;, submitter_id &lt;dbl&gt;, submitter_name &lt;chr&gt;,</span></a>
<a class="sourceLine" id="cb18-75" title="75"><span class="co">#&gt; #   attachments_present &lt;dbl&gt;, attachments_expected &lt;dbl&gt;, status &lt;chr&gt;</span></a>
<a class="sourceLine" id="cb18-76" title="76"><span class="co"># Further: create map with popups, see vignette "odata"</span></a></code></pre></div>
</div>
<div id="list-submissions-for-one-form" class="section level2">
<h2 class="hasAnchor">
<a href="#list-submissions-for-one-form" class="anchor"></a>List submissions for one form</h2>
<p>Not always is it appropriate to download all submissions and all attachments at once.</p>
<p>If forms feed into downstream data warehouses, the typical ETL workflow is to</p>
<ul>
<li>List all submissions from ODK Central</li>
<li>Select the subset of new submissions to download, e.g.
<ul>
<li>Submissions younger than the oldest submission date in the data warehouse.</li>
<li>Submissions whose <code>instance_id</code> is not already present in the data warehouse.</li>
</ul>
</li>
<li>Download only the selected submissions.</li>
<li>Download attachments of only the selected submissions.</li>
</ul>
<div class="sourceCode" id="cb19"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb19-1" title="1">fq_submission_list &lt;-<span class="st"> </span>ruODK<span class="op">::</span><span class="kw"><a href="https://rdrr.io/pkg/ruODK/man/submission_list.html">submission_list</a></span>()</a></code></pre></div>
<div class="sourceCode" id="cb20"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb20-1" title="1">fq_submission_list <span class="op">%&gt;%</span><span class="st"> </span>knitr<span class="op">::</span><span class="kw"><a href="https://rdrr.io/pkg/knitr/man/kable.html">kable</a></span>(.)</a></code></pre></div>
<table class="table">
<thead><tr class="header">
<th align="left">instance_id</th>
<th align="right">submitter_id</th>
<th align="left">device_id</th>
<th align="left">created_at</th>
<th align="left">updated_at</th>
</tr></thead>
<tbody>
<tr class="odd">
<td align="left">uuid:d5e78a78-34db-483d-978f-d9c9a3bc7b69</td>
<td align="right">241</td>
<td align="left">android_id:f73d2e1221ceaa06</td>
<td align="left">2019-09-18 08:51:07</td>
<td align="left">NA</td>
</tr>
<tr class="even">
<td align="left">uuid:529cb189-8bb2-4cf1-9041-dcde716efb4f</td>
<td align="right">241</td>
<td align="left">android_id:f73d2e1221ceaa06</td>
<td align="left">2019-09-18 06:20:25</td>
<td align="left">NA</td>
</tr>
</tbody>
</table>
<p>The list of submissions critically contains each submission’s unique ID in <code>instance_id</code>. If the submissions shall be downloaded and uploaded into another data warehouse, the <code>instance_id</code> can be used to determine whether a record already exists in the downstream warehouse or not. This workflow is preferable where the majority of submissions is already imported into another downstream data warehouse, and we only want to add new submissions, as in submissions which are not already imported into the data warehouse.</p>
<p>Furthermore, the <code>instance_id</code>s can now be used to retrieve the actual submissions.</p>
</div>
<div id="get-submission-data" class="section level2">
<h2 class="hasAnchor">
<a href="#get-submission-data" class="anchor"></a>Get submission data</h2>
<p>In order to import each submission, we need to retrieve the data by <code>instance_id</code>.</p>
<div class="sourceCode" id="cb21"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb21-1" title="1"><span class="co"># One submission</span></a>
<a class="sourceLine" id="cb21-2" title="2">fq_one_submission &lt;-<span class="st"> </span>ruODK<span class="op">::</span><span class="kw"><a href="https://rdrr.io/pkg/ruODK/man/get_one_submission.html">get_one_submission</a></span>(fq_submission_list<span class="op">$</span>instance_id[[<span class="dv">1</span>]])</a>
<a class="sourceLine" id="cb21-3" title="3"></a>
<a class="sourceLine" id="cb21-4" title="4"><span class="co"># Multiple submissions</span></a>
<a class="sourceLine" id="cb21-5" title="5">fq_submissions &lt;-<span class="st"> </span>ruODK<span class="op">::</span><span class="kw"><a href="https://rdrr.io/pkg/ruODK/man/submission_get.html">submission_get</a></span>(fq_submission_list<span class="op">$</span>instance_id)</a></code></pre></div>
</div>
<div id="parse-submissions" class="section level2">
<h2 class="hasAnchor">
<a href="#parse-submissions" class="anchor"></a>Parse submissions</h2>
<p>The data in <code>sub</code> is one row of the bulk downloaded submissions in <code>data_quadrat</code>. The data in <code>submissions</code> represents all (or let’s pretend, the selected) submissions in <code>data_quadrat</code>. The field <code>xml</code> contains the actual submission data including repeating groups.</p>
<p>The structure is different to the output of <code><a href="../reference/odata_submission_get.html">ruODK::odata_submission_get</a></code>, therefore <code><a href="../reference/odata_submission_parse.html">ruODK::odata_submission_parse</a></code> does not work for those, as here we might have repeating groups included in a submission.</p>
<p>This structure could be used for upload into data warehouses accepting nested data as e.g. JSON.</p>
<div class="sourceCode" id="cb22"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb22-1" title="1">listviewer<span class="op">::</span><span class="kw"><a href="https://rdrr.io/pkg/listviewer/man/jsonedit.html">jsonedit</a></span>(fq_submissions, <span class="dt">mode =</span> <span class="st">"code"</span>)</a></code></pre></div>
<div id="htmlwidget-21caf4e5fd711072971e" style="width:672px;height:432.632880098888px;" class="jsonedit html-widget"></div>
<script type="application/json" data-for="htmlwidget-21caf4e5fd711072971e">{"x":{"data":[{"meta":{"instanceID":["uuid:d5e78a78-34db-483d-978f-d9c9a3bc7b69"]},"encounter_start_datetime":["2019-09-18T16:12:21.147+08:00"],"reporter":["Florian Mayer"],"device_id":["f73d2e1221ceaa06"],"location":{"area_name":["Kensington Carpark 01"],"quadrat_photo":["1568794395624.jpg"],"corner1":["-31.99605811 115.88456271 6.404510498046875 4.288"]},"habitat":{"morphological_type":["mid-slope"],"morphological_type_photo":["1568794560256.jpg"]},"vegetation_stratum":{"nvis_level3_broad_floristic_group":["w1.0_trees_with_dominant_genus"],"max_height_m":["3.0"],"foliage_cover":["10-5"],"dominant_species_1":["Euc big fruit"],"dominant_species_2":[],"dominant_species_3":[],"dominant_species_4":[]},"vegetation_stratum.1":{"nvis_level3_broad_floristic_group":["w3.0_shrub"],"max_height_m":["2.0"],"foliage_cover":["30-10"],"dominant_species_1":["Blue bush"],"dominant_species_2":["Xmas shrub"],"dominant_species_3":["Pom poms "],"dominant_species_4":["Salt bush"]},"vegetation_stratum.2":{"nvis_level3_broad_floristic_group":["g4.0_sedge"],"max_height_m":[],"foliage_cover":["5-0"],"dominant_species_1":["Tall spiky"],"dominant_species_2":[],"dominant_species_3":[],"dominant_species_4":[]},"vegetation_stratum.3":{"nvis_level3_broad_floristic_group":["w3.0_shrub"],"max_height_m":["0.5"],"foliage_cover":["30-10"],"dominant_species_1":["Erem green frost"],"dominant_species_2":["Banks is candles "],"dominant_species_3":["Conostylis yellow"],"dominant_species_4":[]},"vegetation_stratum.4":{"nvis_level3_broad_floristic_group":["m1.0_bryophyte"],"max_height_m":["0.05"],"foliage_cover":["5-0"],"dominant_species_1":["Moss town"],"dominant_species_2":[],"dominant_species_3":[],"dominant_species_4":[]},"perimeter":{"corner2":["-31.99622531 115.88435548 -26.305694580078125 4.288"],"corner3":["-31.99614759 115.88436077 -17.897552490234375 4.288"],"corner4":["-31.99610179 115.88432984 -27.75933837890625 4.288"],"mudmap_photo":[]},"taxon_encounter":{"field_name":["Conostylis yellow"],"photo_in_situ":["1568795382633.jpg"],"taxon_encounter_location":["-31.99605058 115.88433281 -25.6241455078125 4.288"],"life_form":["g2.0_tussock_grass"],"voucher_specimen_barcode":["09929760"],"voucher_specimen_label":["JD001"]},"taxon_encounter.1":{"field_name":["Blue bush"],"photo_in_situ":["1568795579890.jpg"],"taxon_encounter_location":["-31.99601125 115.88439814 -14.467254638671875 4.288"],"life_form":[],"voucher_specimen_barcode":[],"voucher_specimen_label":["JD002"]},"encounter_end_datetime":["2019-09-18T16:40:46.155+08:00"]},{"meta":{"instanceID":["uuid:529cb189-8bb2-4cf1-9041-dcde716efb4f"]},"encounter_start_datetime":["2019-09-18T14:08:43.257+08:00"],"reporter":["Florian Mayer"],"device_id":["f73d2e1221ceaa06"],"location":{"area_name":["Kensington Planter Box 1"],"quadrat_photo":["1568786958640.jpg"],"corner1":["-31.99614843 115.88433971 -17.372406005859375 4.288"]},"habitat":{"morphological_type":["flat"],"morphological_type_photo":["1568787004467.jpg"]},"vegetation_stratum":{"nvis_level3_broad_floristic_group":["w3.0_shrub"],"max_height_m":["3.0"],"foliage_cover":["5-0"],"dominant_species_1":["Plant name 1"],"dominant_species_2":["Plant name 2"],"dominant_species_3":[],"dominant_species_4":[]},"vegetation_stratum.1":{"nvis_level3_broad_floristic_group":["w3.1_heath_shrub"],"max_height_m":["1.0"],"foliage_cover":["100-70"],"dominant_species_1":["Plant name 4"],"dominant_species_2":["Plant name 5"],"dominant_species_3":[],"dominant_species_4":[]},"perimeter":{"corner2":["-31.99620073 115.88438584 -8.6624755859375 4.288"],"corner3":["-31.99622144 115.88440369 -6.266143798828125 4.288"],"corner4":["-31.99620546 115.88438399 -6.597747802734375 4.288"],"mudmap_photo":["1568787172983.jpg"]},"taxon_encounter":{"field_name":["Pileanthus sp. Peachy flowers"],"photo_in_situ":["1568787220913.jpg"],"taxon_encounter_location":["-31.99626091 115.88424501 -64.94879150390625 4.288"],"life_form":["w3.0_shrub"],"voucher_specimen_barcode":["08173089"],"voucher_specimen_label":[]},"taxon_encounter.1":{"field_name":["Small pink flowers"],"photo_in_situ":["1568787333689.jpg"],"taxon_encounter_location":["-31.99623047 115.88428544 -44.85186767578125 4.288"],"life_form":["w3.1_heath_shrub"],"voucher_specimen_barcode":[],"voucher_specimen_label":["FM001"]},"taxon_encounter.2":{"field_name":["Small red flowers"],"photo_in_situ":["1568787380833.jpg"],"taxon_encounter_location":["-31.99616689 115.88450938 -0.85919189453125 4.288"],"life_form":[],"voucher_specimen_barcode":[],"voucher_specimen_label":["FM002"]},"taxon_encounter.3":{"field_name":["Funky grass violet flowers"],"photo_in_situ":["1568787456664.jpg"],"taxon_encounter_location":["-31.99617326 115.88441209 -9.488067626953125 4.288"],"life_form":["g4.0_sedge"],"voucher_specimen_barcode":[],"voucher_specimen_label":["FM003"]},"taxon_encounter.4":{"field_name":["Sharp edged red flowers"],"photo_in_situ":["1568787504877.jpg"],"taxon_encounter_location":["-31.9962021 115.88442761 -12.5390625 4.288"],"life_form":["w3.1_heath_shrub"],"voucher_specimen_barcode":[],"voucher_specimen_label":["FM004"]},"encounter_end_datetime":["2019-09-18T14:18:53.583+08:00"]}],"options":{"mode":"code","modes":["code","form","text","tree","view"]}},"evals":[],"jsHooks":[]}</script>
</div>
<div id="rectangling-the-submissions" class="section level2">
<h2 class="hasAnchor">
<a href="#rectangling-the-submissions" class="anchor"></a>Rectangling the submissions</h2>
<p>For a more traditional analysis, we need the data in a rectangular shape. The unpredictably nested structure of the submission data (when containing repeated subgroups) makes it challenging to do this in an automated fashion.</p>
<p>While both the ZIP export and the OData API provide clean, rectangular versions of the data, we’ll still attempt here to un-nest the nested list of submission data into a rectangular <code>tibble</code>.</p>
<p>In the example shown above, the repeated <code>taxon_encounter</code> groups are named <code>taxon_encounter</code>, <code>taxon_encounter.1</code> and so on. This is an artifact of the <code>jsonedit::listviewer()</code> widget.</p>
<p>With one additional step we can flatten the nested lists and bind them into one dataframe, then sanitise the column names and parse datetimes like we did with the CSV export.</p>
<p>It appears this operation loses all but the last repeat of repeating groups. We should further also deparse locations (WKT) into latitude, longitude, altitude and accuracy.</p>
<div class="sourceCode" id="cb23"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb23-1" title="1">sub_parsed &lt;-<span class="st"> </span>fq_submissions <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb23-2" title="2"><span class="st">  </span>purrr<span class="op">::</span><span class="kw"><a href="https://purrr.tidyverse.org/reference/map.html">map_df</a></span>(rlist<span class="op">::</span>list.flatten) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb23-3" title="3"><span class="st">  </span>janitor<span class="op">::</span><span class="kw"><a href="https://rdrr.io/pkg/janitor/man/clean_names.html">clean_names</a></span>(.) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb23-4" title="4"><span class="st">  </span>ruODK<span class="op">::</span><span class="kw"><a href="https://rdrr.io/pkg/ruODK/man/ru_datetime.html">ru_datetime</a></span>(.)</a>
<a class="sourceLine" id="cb23-5" title="5"></a>
<a class="sourceLine" id="cb23-6" title="6"><span class="kw"><a href="https://rdrr.io/r/base/names.html">names</a></span>(sub_parsed)</a>
<a class="sourceLine" id="cb23-7" title="7"><span class="co">#&gt;  [1] "meta_instance_id"                                    </span></a>
<a class="sourceLine" id="cb23-8" title="8"><span class="co">#&gt;  [2] "encounter_start_datetime"                            </span></a>
<a class="sourceLine" id="cb23-9" title="9"><span class="co">#&gt;  [3] "reporter"                                            </span></a>
<a class="sourceLine" id="cb23-10" title="10"><span class="co">#&gt;  [4] "device_id"                                           </span></a>
<a class="sourceLine" id="cb23-11" title="11"><span class="co">#&gt;  [5] "location_area_name"                                  </span></a>
<a class="sourceLine" id="cb23-12" title="12"><span class="co">#&gt;  [6] "location_quadrat_photo"                              </span></a>
<a class="sourceLine" id="cb23-13" title="13"><span class="co">#&gt;  [7] "location_corner1"                                    </span></a>
<a class="sourceLine" id="cb23-14" title="14"><span class="co">#&gt;  [8] "habitat_morphological_type"                          </span></a>
<a class="sourceLine" id="cb23-15" title="15"><span class="co">#&gt;  [9] "habitat_morphological_type_photo"                    </span></a>
<a class="sourceLine" id="cb23-16" title="16"><span class="co">#&gt; [10] "vegetation_stratum_nvis_level3_broad_floristic_group"</span></a>
<a class="sourceLine" id="cb23-17" title="17"><span class="co">#&gt; [11] "vegetation_stratum_max_height_m"                     </span></a>
<a class="sourceLine" id="cb23-18" title="18"><span class="co">#&gt; [12] "vegetation_stratum_foliage_cover"                    </span></a>
<a class="sourceLine" id="cb23-19" title="19"><span class="co">#&gt; [13] "vegetation_stratum_dominant_species_1"               </span></a>
<a class="sourceLine" id="cb23-20" title="20"><span class="co">#&gt; [14] "vegetation_stratum_dominant_species_2"               </span></a>
<a class="sourceLine" id="cb23-21" title="21"><span class="co">#&gt; [15] "vegetation_stratum_dominant_species_3"               </span></a>
<a class="sourceLine" id="cb23-22" title="22"><span class="co">#&gt; [16] "vegetation_stratum_dominant_species_4"               </span></a>
<a class="sourceLine" id="cb23-23" title="23"><span class="co">#&gt; [17] "perimeter_corner2"                                   </span></a>
<a class="sourceLine" id="cb23-24" title="24"><span class="co">#&gt; [18] "perimeter_corner3"                                   </span></a>
<a class="sourceLine" id="cb23-25" title="25"><span class="co">#&gt; [19] "perimeter_corner4"                                   </span></a>
<a class="sourceLine" id="cb23-26" title="26"><span class="co">#&gt; [20] "taxon_encounter_field_name"                          </span></a>
<a class="sourceLine" id="cb23-27" title="27"><span class="co">#&gt; [21] "taxon_encounter_photo_in_situ"                       </span></a>
<a class="sourceLine" id="cb23-28" title="28"><span class="co">#&gt; [22] "taxon_encounter_taxon_encounter_location"            </span></a>
<a class="sourceLine" id="cb23-29" title="29"><span class="co">#&gt; [23] "taxon_encounter_life_form"                           </span></a>
<a class="sourceLine" id="cb23-30" title="30"><span class="co">#&gt; [24] "taxon_encounter_voucher_specimen_barcode"            </span></a>
<a class="sourceLine" id="cb23-31" title="31"><span class="co">#&gt; [25] "taxon_encounter_voucher_specimen_label"              </span></a>
<a class="sourceLine" id="cb23-32" title="32"><span class="co">#&gt; [26] "encounter_end_datetime"                              </span></a>
<a class="sourceLine" id="cb23-33" title="33"><span class="co">#&gt; [27] "perimeter_mudmap_photo"</span></a>
<a class="sourceLine" id="cb23-34" title="34"><span class="kw"><a href="https://rdrr.io/r/utils/head.html">head</a></span>(sub_parsed)</a>
<a class="sourceLine" id="cb23-35" title="35"><span class="co">#&gt; # A tibble: 2 x 27</span></a>
<a class="sourceLine" id="cb23-36" title="36"><span class="co">#&gt;   meta_instance_id encounter_start_da… reporter device_id location_area_n…</span></a>
<a class="sourceLine" id="cb23-37" title="37"><span class="co">#&gt;   &lt;chr&gt;            &lt;dttm&gt;              &lt;chr&gt;    &lt;chr&gt;     &lt;chr&gt;           </span></a>
<a class="sourceLine" id="cb23-38" title="38"><span class="co">#&gt; 1 uuid:d5e78a78-3… 2019-09-18 08:12:21 Florian… f73d2e12… Kensington Carp…</span></a>
<a class="sourceLine" id="cb23-39" title="39"><span class="co">#&gt; 2 uuid:529cb189-8… 2019-09-18 06:08:43 Florian… f73d2e12… Kensington Plan…</span></a>
<a class="sourceLine" id="cb23-40" title="40"><span class="co">#&gt; # … with 22 more variables: location_quadrat_photo &lt;chr&gt;,</span></a>
<a class="sourceLine" id="cb23-41" title="41"><span class="co">#&gt; #   location_corner1 &lt;chr&gt;, habitat_morphological_type &lt;chr&gt;,</span></a>
<a class="sourceLine" id="cb23-42" title="42"><span class="co">#&gt; #   habitat_morphological_type_photo &lt;chr&gt;,</span></a>
<a class="sourceLine" id="cb23-43" title="43"><span class="co">#&gt; #   vegetation_stratum_nvis_level3_broad_floristic_group &lt;chr&gt;,</span></a>
<a class="sourceLine" id="cb23-44" title="44"><span class="co">#&gt; #   vegetation_stratum_max_height_m &lt;chr&gt;,</span></a>
<a class="sourceLine" id="cb23-45" title="45"><span class="co">#&gt; #   vegetation_stratum_foliage_cover &lt;chr&gt;,</span></a>
<a class="sourceLine" id="cb23-46" title="46"><span class="co">#&gt; #   vegetation_stratum_dominant_species_1 &lt;chr&gt;,</span></a>
<a class="sourceLine" id="cb23-47" title="47"><span class="co">#&gt; #   vegetation_stratum_dominant_species_2 &lt;chr&gt;,</span></a>
<a class="sourceLine" id="cb23-48" title="48"><span class="co">#&gt; #   vegetation_stratum_dominant_species_3 &lt;chr&gt;,</span></a>
<a class="sourceLine" id="cb23-49" title="49"><span class="co">#&gt; #   vegetation_stratum_dominant_species_4 &lt;chr&gt;, perimeter_corner2 &lt;chr&gt;,</span></a>
<a class="sourceLine" id="cb23-50" title="50"><span class="co">#&gt; #   perimeter_corner3 &lt;chr&gt;, perimeter_corner4 &lt;chr&gt;,</span></a>
<a class="sourceLine" id="cb23-51" title="51"><span class="co">#&gt; #   taxon_encounter_field_name &lt;chr&gt;, taxon_encounter_photo_in_situ &lt;chr&gt;,</span></a>
<a class="sourceLine" id="cb23-52" title="52"><span class="co">#&gt; #   taxon_encounter_taxon_encounter_location &lt;chr&gt;,</span></a>
<a class="sourceLine" id="cb23-53" title="53"><span class="co">#&gt; #   taxon_encounter_life_form &lt;chr&gt;,</span></a>
<a class="sourceLine" id="cb23-54" title="54"><span class="co">#&gt; #   taxon_encounter_voucher_specimen_barcode &lt;chr&gt;,</span></a>
<a class="sourceLine" id="cb23-55" title="55"><span class="co">#&gt; #   taxon_encounter_voucher_specimen_label &lt;chr&gt;,</span></a>
<a class="sourceLine" id="cb23-56" title="56"><span class="co">#&gt; #   encounter_end_datetime &lt;dttm&gt;, perimeter_mudmap_photo &lt;chr&gt;</span></a></code></pre></div>
</div>
</div>
<div id="attachments" class="section level1">
<h1 class="hasAnchor">
<a href="#attachments" class="anchor"></a>Attachments</h1>
<div id="list-all-attachments-for-one-form" class="section level2">
<h2 class="hasAnchor">
<a href="#list-all-attachments-for-one-form" class="anchor"></a>List all attachments for one form</h2>
<div class="sourceCode" id="cb24"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb24-1" title="1">fq_attachments &lt;-<span class="st"> </span>ruODK<span class="op">::</span><span class="kw"><a href="https://rdrr.io/pkg/ruODK/man/attachment_list.html">attachment_list</a></span>(sl<span class="op">$</span>instance_id)</a></code></pre></div>
<div class="sourceCode" id="cb25"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb25-1" title="1"><span class="kw"><a href="https://rdrr.io/r/utils/head.html">head</a></span>(fq_attachments)</a>
<a class="sourceLine" id="cb25-2" title="2"><span class="co">#&gt; # A tibble: 6 x 2</span></a>
<a class="sourceLine" id="cb25-3" title="3"><span class="co">#&gt;   name              exists</span></a>
<a class="sourceLine" id="cb25-4" title="4"><span class="co">#&gt;   &lt;chr&gt;             &lt;lgl&gt; </span></a>
<a class="sourceLine" id="cb25-5" title="5"><span class="co">#&gt; 1 1568794395624.jpg TRUE  </span></a>
<a class="sourceLine" id="cb25-6" title="6"><span class="co">#&gt; 2 1568794560256.jpg TRUE  </span></a>
<a class="sourceLine" id="cb25-7" title="7"><span class="co">#&gt; 3 1568795382633.jpg TRUE  </span></a>
<a class="sourceLine" id="cb25-8" title="8"><span class="co">#&gt; 4 1568795579890.jpg TRUE  </span></a>
<a class="sourceLine" id="cb25-9" title="9"><span class="co">#&gt; 5 1568786958640.jpg TRUE  </span></a>
<a class="sourceLine" id="cb25-10" title="10"><span class="co">#&gt; 6 1568787004467.jpg TRUE</span></a></code></pre></div>
</div>
<div id="get-attachments" class="section level2">
<h2 class="hasAnchor">
<a href="#get-attachments" class="anchor"></a>Get attachments</h2>
<p><code><a href="../reference/attachment_get.html">ruODK::attachment_get</a></code> downloads the attachment files and links them similar to <code><a href="../reference/attachment_link.html">ruODK::attachment_link</a></code> (which assumes that attachments have already been downloaded).</p>
<div class="sourceCode" id="cb26"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb26-1" title="1">sub_att &lt;-<span class="st"> </span>sub_parsed <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb26-2" title="2"><span class="st">  </span>dplyr<span class="op">::</span><span class="kw"><a href="https://dplyr.tidyverse.org/reference/mutate.html">mutate</a></span>(</a>
<a class="sourceLine" id="cb26-3" title="3">    <span class="dt">location_quadrat_photo =</span> ruODK<span class="op">::</span><span class="kw"><a href="https://rdrr.io/pkg/ruODK/man/attachment_get.html">attachment_get</a></span>(</a>
<a class="sourceLine" id="cb26-4" title="4">        meta_instance_id,</a>
<a class="sourceLine" id="cb26-5" title="5">        location_quadrat_photo,</a>
<a class="sourceLine" id="cb26-6" title="6">        <span class="dt">local_dir =</span> fs<span class="op">::</span><span class="kw"><a href="http://fs.r-lib.org/reference/path.html">path</a></span>(<span class="st">"attachments"</span>, <span class="st">"media"</span>)</a>
<a class="sourceLine" id="cb26-7" title="7">    )</a>
<a class="sourceLine" id="cb26-8" title="8">    <span class="co"># same for all other attachments</span></a>
<a class="sourceLine" id="cb26-9" title="9">    <span class="co"># requires knowledge or introspection of form schema</span></a>
<a class="sourceLine" id="cb26-10" title="10">  )</a>
<a class="sourceLine" id="cb26-11" title="11"></a>
<a class="sourceLine" id="cb26-12" title="12"><span class="co"># Show attachment with relative path</span></a>
<a class="sourceLine" id="cb26-13" title="13">sub_att<span class="op">$</span>location_quadrat_photo</a>
<a class="sourceLine" id="cb26-14" title="14"></a>
<a class="sourceLine" id="cb26-15" title="15"><span class="co"># List corresponding files</span></a>
<a class="sourceLine" id="cb26-16" title="16">fs<span class="op">::</span><span class="kw"><a href="http://fs.r-lib.org/reference/dir_ls.html">dir_ls</a></span>(t, <span class="dt">recurse =</span> <span class="ot">TRUE</span>, <span class="dt">glob =</span> <span class="st">"*.jpg"</span>)</a></code></pre></div>
</div>
</div>
<div id="outlook" class="section level1">
<h1 class="hasAnchor">
<a href="#outlook" class="anchor"></a>Outlook</h1>
<p>From here, we can use the separately created data tibbles and locally downloaded attachments to build visualisations as shown in the vignette “odata”.</p>
<p>The best course of action seems to be the data export to ZIP or use the OData API.</p>
</div>
<div id="future-development" class="section level1">
<h1 class="hasAnchor">
<a href="#future-development" class="anchor"></a>Future development</h1>
<p>In future versions of <code>ruODK</code>, we’ll introspect <code>form_schema</code> to determine the names of repeating groups, the form field names of attachments (data type “binary” in form schema), the form field names of date/time fields (data type “dateTime”), and use this introspection to further automate the data extraction process shown above.</p>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="sidebar">

        <div id="tocnav">
      <h2 class="hasAnchor">
<a href="#tocnav" class="anchor"></a>Contents</h2>
      <ul class="nav nav-pills nav-stacked">
<li>
<a href="#scope">Scope</a><ul class="nav nav-pills nav-stacked">
<li><a href="#three-ways-to-happiness">Three ways to happiness</a></li>
      </ul>
</li>
      <li><a href="#setup-ruodk">Setup ruODK</a></li>
      <li><a href="#projects">Projects</a></li>
      <li>
<a href="#forms">Forms</a><ul class="nav nav-pills nav-stacked">
<li><a href="#list-forms-for-a-project">List forms for a project</a></li>
      <li><a href="#inspect-form-schema">Inspect form schema</a></li>
      <li><a href="#show-details-of-one-form">Show details of one form</a></li>
      </ul>
</li>
      <li>
<a href="#submissions">Submissions</a><ul class="nav nav-pills nav-stacked">
<li><a href="#get-all-submissions-for-one-form">Get all submissions for one form</a></li>
      <li><a href="#list-submissions-for-one-form">List submissions for one form</a></li>
      <li><a href="#get-submission-data">Get submission data</a></li>
      <li><a href="#parse-submissions">Parse submissions</a></li>
      <li><a href="#rectangling-the-submissions">Rectangling the submissions</a></li>
      </ul>
</li>
      <li>
<a href="#attachments">Attachments</a><ul class="nav nav-pills nav-stacked">
<li><a href="#list-all-attachments-for-one-form">List all attachments for one form</a></li>
      <li><a href="#get-attachments">Get attachments</a></li>
      </ul>
</li>
      <li><a href="#outlook">Outlook</a></li>
      <li><a href="#future-development">Future development</a></li>
      </ul>
</div>
      </div>

</div>



      <footer><div class="copyright">
  <p>Developed by Florian W. Mayer, <a href="https://www.dbca.wa.gov.au/science/"><img src="man/figures/dbca_bcs.png" width="150" alt="DBCA"></a>, <a href="https://flatbacks.dbca.wa.gov.au/"><img src="man/figures/flatbacks.svg" width="150" alt="NWSFTCP"></a>.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.4.1.</p>
</div>

      </footer>
</div>

  


  </body>
</html>
