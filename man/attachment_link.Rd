% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/attachment_link.R
\name{attachment_link}
\alias{attachment_link}
\title{Prefix attachment columns from CSV export with a local attachment file path.}
\usage{
attachment_link(data_tbl, att_path = "media", att_contains = "photo")
}
\arguments{
\item{data_tbl}{The downloaded submissions from
\code{`ruODK::submission_export()`} read into a `tibble` by
\code{`readr::read_csv()`}.}

\item{att_path}{A local path, default: "media" (as per .csv.zip export).
Selected columns of the dataframe (containing attchment filenames) are
prefixed with `att_path`, thus turning them into relative paths.}

\item{att_contains}{A shared part of attachment fieldnames, default: "photo".
Columns of the dataframe are selected by the presence of `att_contains`.}
}
\value{
The dataframe with attachment columns modified to contain relative
  paths to the downloaded attachment files.
}
\description{
\lifecycle{maturing}
}
\examples{
\dontrun{
t <- tempdir()
# Set default credentials, see vignette "setup"
ruODK::ru_setup(
  svc = paste0(
    "https://sandbox.central.opendatakit.org/v1/projects/14/",
    "forms/build_Flora-Quadrat-0-2_1558575936.svc"
  ),
  un = "me@email.com",
  pw = "..."
)

# Predict filenames (with knowledge of form)
fid <- get_default_fid()
fid_csv <- fs::path(t, glue::glue("{fid}.csv"))
fid_csv_tae <- fs::path(t, glue::glue("{fid}-taxon_encounter.csv"))

# Download the zip file
se <- ruODK::submission_export(
  local_dir = t,
  overwrite = FALSE,
  verbose = TRUE
)

# Unpack the zip file
f <- unzip(se, exdir = t)
fs::dir_ls(t)

# Prepend attachments with media/ to turn into relative file paths
data_quadrat <- fid_csv %>%
  readr::read_csv(na = c("", "NA", "na")) %>%
  janitor::clean_names(.) %>%
  attachment_link(.) %>%
  parse_datetime(tz = "Australia/Perth")
}
}
\seealso{
Other restful-api: 
\code{\link{attachment_list}()},
\code{\link{audit_get}()},
\code{\link{form_detail}()},
\code{\link{form_list}()},
\code{\link{form_schema_parse}()},
\code{\link{form_schema}()},
\code{\link{form_xml}()},
\code{\link{project_create}()},
\code{\link{project_detail}()},
\code{\link{project_list}()},
\code{\link{submission_detail}()},
\code{\link{submission_export}()},
\code{\link{submission_get}()},
\code{\link{submission_list}()}
}
\concept{restful-api}
